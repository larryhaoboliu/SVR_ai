function createCompany(){var n=$("#NewCompanyName").val(),t=$("#NewAbbreviation").val(),i=parseInt($("#ProjectId").val());if(!n||!t||i<=0){$("#newCompanyModal").modal("hide");return}$.post("/Items/AddCompany",{companyName:n,abbreviation:t,projectId:i}).done(function(t){$("#CompanyId").empty();$("#CompanyId").append('<option value="0">(Select)<\/option>');$.each(t,function(t,i){$("#CompanyId").append('<option value="'+i.CompanyId+'"'+(n===i.CompanyName?" selected":"")+">"+i.CompanyName+"<\/option>")});$("#NewCompanyName").val("");$("#NewAbbreviation").val("");$("#newCompanyModal").modal("hide")})}function createLocation(){var n=$("#NewLocation").val(),t=parseInt($("#ProjectId").val());if(!n||t<=0){$("#newLocationModal").modal("hide");return}$.post("/Items/AddLocation",{locationName:n,projectId:t,itemId:0}).done(function(t){$("#LocationId").empty();$("#LocationId").append('<option value="0">(Select)<\/option>');$.each(t,function(t,i){$("#LocationId").append('<option value="'+i.LocationId+'"'+(n===i.LocationName?" selected":"")+">"+i.LocationName+"<\/option>")});$("#NewLocation").val("");$("#newLocationModal").modal("hide")})}function deleteItemPhoto(n,t,i,r){var u=$("#formCreateItem").serializeArray();u.push({name:"itemPhotoId",value:n});u.push({name:"filePathOriginal",value:i});u.push({name:"filePathResized",value:r});bootbox.confirm("Delete photo? This cannot be undone.",function(n){n&&$.post("/Items/DeletePhoto",u).done(function(n){$("#photos").html(n);ItemCreateManager.initSort()})})}$(function(){ItemCreateManager.startup();$("body").on("change","#ItemTypeId",function(){$.get("/Items/GetAllowedItemStates/?itemTypeId="+$(this).val()).done(function(n){$("#ItemStateId").html(n)})});$("body").on("click","#btnAddCompany",function(){$("#newCompanyModal").modal("show")});$("body").on("click","#btnOkCreateCompany",function(){createCompany()});$("body").on("click","#btnAddLocation",function(){$("#newLocationModal").modal("show")});$("body").on("click","#btnOkCreateLocation",function(){createLocation()});$("body").on("keypress change paste","input",function(n){if(n.which===13){var t=$(this).attr("id");(t==="NewLocation"||t==="btnOkCreateLocation")&&$("#btnOkCreateLocation").focus().click()}});saveAndClose("btnSaveClose","formCreateItem");saveAndNew("btnSaveNew","formCreateItem");$("body").on("click",".js-deletePhoto",function(){var n=$(this).data("item-photo-id"),t=$(this).data("item-id"),i=$(this).data("file-path-original"),r=$(this).data("file-path-resized");deleteItemPhoto(n,t,i,r)});$("body").on("click",".js-rotate-photo",function(){var n=$(this).data("image-id"),t=$(this).data("file-path-original"),i=$(this).data("file-path-resized");ItemCreateManager.rotatePhoto(t,i,$("#"+n))})});var ItemCreateManager={startup:function(){$(".nav-pills").scrollingTabs({disableScrollArrowsOnFullyScrolled:!0});AutoSave.init({formId:"formCreateItem"});var n=AutoSave.getJson();n?bootbox.confirm({message:"You have a report item that you did not save previously.  Continue where you left off?",buttons:{cancel:{label:"No"},confirm:{label:"Yes"}},callback:function(t){t?ItemCreateManager.restoreDetails(n):(AutoSave.clear(),ItemCreateManager.initForm())}}):ItemCreateManager.initForm()},initForm:function(){var n=moment($("#CreatedDate").val(),"M/D/YYYY H:mm:ss A");$("#CreatedDate").val(n.format("L"));$("#CreatedDate").datetimepicker({lang:"en",format:"m/d/Y",timepicker:!1});$("#CompletedDate").datetimepicker({lang:"en",format:"m/d/Y",timepicker:!1});ItemCreateManager.initEditors();ItemCreateManager.initSort()},initEditors:function(){$(".rich-editor").redactor({formattingTags:["p","h1","h2","h3","h4","h5"],buttons:["formatting","|","bold","italic","underline","|","unorderedlist","orderedlist","|","alignment"],tabAsSpaces:4})},initSort:function(){Sortable.create($("#draggable-photo-container")[0],{handle:".js-drag-handle",animation:150,onSort:function(){$(".js-sort-photo").each(function(n){$(this).val(n+1)});AutoSave.save()}})},restoreDetails:function(n){$.post("/Items/RestoreDetails",n).done(function(t){$("#itemDetails").html(t);ItemCreateManager.restorePhotos(n)})},restorePhotos:function(n){$.post("/Items/RestorePhotos",n).done(function(n){$("#photos").html(n);ItemCreateManager.initForm()})},rotatePhoto:function(n,t,i){var r=i.attr("src");$.post("/Items/RotatePhoto",{filePathOriginal:n,filePathResized:t}).done(function(){var n=new Date;i.attr("src",r+"&"+n.getTime())})}};Dropzone.options.dropzoneForm={paramName:"files",maxFilesize:10,uploadMultiple:!0,parallelUploads:100,init:function(){var n=this;n.on("sendingmultiple",function(n,t,i){for(var u=$("#formCreateItem").serializeArray(),r=0;r<u.length;r++)i.append([u[r].name],u[r].value)});n.on("completemultiple",function(t){$("#photos").html(t[0].xhr.response);n.removeAllFiles();ItemCreateManager.initSort();AutoSave.save()})}};!function(n){"use strict";"function"==typeof define&&define.amd?define(n):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=n():window.Sortable=n()}(function(){"use strict";function h(n,t){var f,u,i;if(!n||!n.nodeType||1!==n.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(n);this.el=n;this.options=t=ei({},t);n[g]=this;f={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(n.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(n,t){n.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:h.supportPointer!==!1};for(u in f)u in t||(t[u]=f[u]);ai(t);for(i in this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&gi;r(n,"mousedown",this._onTapStart);r(n,"touchstart",this._onTapStart);t.supportPointer&&r(n,"pointerdown",this._onTapStart);this.nativeDraggable&&(r(n,"dragover",this),r(n,"dragenter",this));ft.push(this._onDragOver);t.store&&this.sort(t.store.get(this))}function lt(i,r){"clone"!==i.lastPullMode&&(r=!0);o&&o.state!==r&&(u(o,"display",r?"none":""),r||o.state&&(i.options.group.revertClone?(t.insertBefore(o,nt),i._animate(n,o)):t.insertBefore(o,n)),o.state=r)}function b(n,t,i){if(n){i=i||f;do if(">*"===t&&n.parentNode===i||ui(n,t))return n;while(n=vi(n))}return null}function vi(n){var t=n.host;return t&&t.nodeType?t:n.parentNode}function yi(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move");ut||n.preventDefault()}function r(n,t,i){n.addEventListener(t,i,dt)}function e(n,t,i){n.removeEventListener(t,i,dt)}function p(n,t,i){if(n)if(n.classList)n.classList[i?"add":"remove"](t);else{var r=(" "+n.className+" ").replace(si," ").replace(" "+t+" "," ");n.className=(r+(i?" "+t:"")).replace(si," ")}}function u(n,t,i){var r=n&&n.style;if(r){if(void 0===i)return f.defaultView&&f.defaultView.getComputedStyle?i=f.defaultView.getComputedStyle(n,""):n.currentStyle&&(i=n.currentStyle),void 0===t?i:i[t];t in r||(t="-webkit-"+t);r[t]=i+("string"==typeof i?"":"px")}}function ti(n,t,i){if(n){var u=n.getElementsByTagName(t),r=0,f=u.length;if(i)for(;r<f;r++)i(u[r],r);return u}return[]}function l(n,t,i,r,u,e,s,h){n=n||t[g];var c=f.createEvent("Event"),l=n.options,a="on"+i.charAt(0).toUpperCase()+i.substr(1);c.initEvent(i,!0,!0);c.to=u||t;c.from=e||t;c.item=r||t;c.clone=o;c.oldIndex=s;c.newIndex=h;t.dispatchEvent(c);l[a]&&l[a].call(n,c)}function ii(n,t,i,r,u,e,o,s){var h,c,l=n[g],a=l.options.onMove;return h=f.createEvent("Event"),h.initEvent("move",!0,!0),h.to=t,h.from=n,h.dragged=i,h.draggedRect=r,h.related=u||t,h.relatedRect=e||t.getBoundingClientRect(),h.willInsertAfter=s,n.dispatchEvent(h),a&&(c=a.call(l,h,o)),c}function ri(n){n.draggable=!1}function pi(){gt=!1}function wi(n,t){var r=n.lastElementChild,i=r.getBoundingClientRect();return t.clientY-(i.top+i.height)>5||t.clientX-(i.left+i.width)>5}function bi(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,i=t.length,r=0;i--;)r+=t.charCodeAt(i);return r.toString(36)}function et(n,t){var i=0;if(!n||!n.parentNode)return-1;for(;n&&(n=n.previousElementSibling);)"TEMPLATE"!==n.nodeName.toUpperCase()&&(">*"===t||ui(n,t))&&i++;return i}function ui(n,t){if(n){t=t.split(".");var i=t.shift().toUpperCase(),r=new RegExp("\\s("+t.join("|")+")(?=\\s)","g");return!(""!==i&&n.nodeName.toUpperCase()!=i||t.length&&((" "+n.className+" ").match(r)||[]).length!=t.length)}return!1}function fi(n,t){var i,r;return function(){void 0===i&&(i=arguments,r=this,rt(function(){1===i.length?n.call(r,i[0]):n.apply(r,i);i=void 0},t))}}function ei(n,t){if(n&&t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function oi(n){return kt&&kt.dom?kt.dom(n).cloneNode(!0):ci?ci(n).clone(!0)[0]:n.cloneNode(!0)}function ki(n){for(var r,t=n.getElementsByTagName("input"),i=t.length;i--;)r=t[i],r.checked&&ni.push(r)}function ot(n){return rt(n,0)}function at(n){return clearTimeout(n)}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document");};var n,s,i,o,t,nt,vt,a,yt,pt,wt,st,bt,y,c,it,ht,d,v,ct,k={},si=/\s+/g,di=/left|right|inline/,g="Sortable"+(new Date).getTime(),w=window,f=w.document,hi=w.parseInt,rt=w.setTimeout,ci=w.jQuery||w.Zepto,kt=w.Polymer,dt=!1,ut=!1,gi="draggable"in f.createElement("div"),li=function(n){return!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&(n=f.createElement("x"),n.style.cssText="pointer-events:auto","auto"===n.style.pointerEvents)}(),gt=!1,tt=Math.abs,nr=Math.min,ni=[],ft=[],tr=fi(function(n,t,i){if(i&&t.scroll){var r,o,u,f,s,h,y=i[g],e=t.scrollSensitivity,v=t.scrollSpeed,c=n.clientX,l=n.clientY,p=window.innerWidth,b=window.innerHeight;if(yt!==i&&(a=t.scroll,yt=i,pt=t.scrollFn,a===!0)){a=i;do if(a.offsetWidth<a.scrollWidth||a.offsetHeight<a.scrollHeight)break;while(a=a.parentNode)}a&&(r=a,o=a.getBoundingClientRect(),u=(tt(o.right-c)<=e)-(tt(o.left-c)<=e),f=(tt(o.bottom-l)<=e)-(tt(o.top-l)<=e));u||f||(u=(p-c<=e)-(c<=e),f=(b-l<=e)-(l<=e),(u||f)&&(r=w));k.vx===u&&k.vy===f&&k.el===r||(k.el=r,k.vx=u,k.vy=f,clearInterval(k.pid),r&&(k.pid=setInterval(function(){return h=f?f*v:0,s=u?u*v:0,"function"==typeof pt?pt.call(y,s,h,n):void(r===w?w.scrollTo(w.pageXOffset+s,w.pageYOffset+h):(r.scrollTop+=h,r.scrollLeft+=s))},24)))}},30),ai=function(n){function r(n,t){return void 0!==n&&n!==!0||(n=i.name),"function"==typeof n?n:function(i,r){var u=r.options.group.name;return t?n:n&&(n.join?n.indexOf(u)>-1:u==n)}}var i={},t=n.group;t&&"object"==typeof t||(t={name:t});i.name=t.name;i.checkPull=r(t.pull,!0);i.checkPut=r(t.put);i.revertClone=t.revertClone;n.group=i};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){ut=!0;dt={capture:!1,passive:ut}}}))}catch(h){}return h.prototype={constructor:h,_onTapStart:function(t){var e,s=this,r=this.el,u=this.options,h=u.preventOnFilter,a=t.type,c=t.touches&&t.touches[0],i=(c||t).target,o=t.target.shadowRoot&&t.path&&t.path[0]||i,f=u.filter;if(ki(r),!n&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||u.disabled)&&!o.isContentEditable&&(i=b(i,u.draggable,r),i&&vt!==i)){if(e=et(i,u.draggable),"function"==typeof f){if(f.call(this,t,i,this))return l(s,o,"filter",i,r,r,e),void(h&&t.preventDefault())}else if(f&&(f=f.split(",").some(function(n){if(n=b(o,n.trim(),r))return l(s,n,"filter",i,r,r,e),!0})))return void(h&&t.preventDefault());u.handle&&!b(o,u.handle,r)||this._prepareDragStart(t,c,i,e)}},_prepareDragStart:function(i,u,f,e){var a,o=this,v=o.el,c=o.options,h=v.ownerDocument;f&&!n&&f.parentNode===v&&(d=i,t=v,n=f,s=n.parentNode,nt=n.nextSibling,vt=f,it=c.group,y=e,this._lastX=(u||i).clientX,this._lastY=(u||i).clientY,n.style["will-change"]="all",a=function(){o._disableDelayedDrag();n.draggable=o.nativeDraggable;p(n,c.chosenClass,!0);o._triggerDragStart(i,u);l(o,t,"choose",n,t,t,y)},c.ignore.split(",").forEach(function(t){ti(n,t.trim(),ri)}),r(h,"mouseup",o._onDrop),r(h,"touchend",o._onDrop),r(h,"touchcancel",o._onDrop),r(h,"selectstart",o),c.supportPointer&&r(h,"pointercancel",o._onDrop),c.delay?(r(h,"mouseup",o._disableDelayedDrag),r(h,"touchend",o._disableDelayedDrag),r(h,"touchcancel",o._disableDelayedDrag),r(h,"mousemove",o._disableDelayedDrag),r(h,"touchmove",o._disableDelayedDrag),c.supportPointer&&r(h,"pointermove",o._disableDelayedDrag),o._dragStartTimer=rt(a,c.delay)):a())},_disableDelayedDrag:function(){var n=this.el.ownerDocument;clearTimeout(this._dragStartTimer);e(n,"mouseup",this._disableDelayedDrag);e(n,"touchend",this._disableDelayedDrag);e(n,"touchcancel",this._disableDelayedDrag);e(n,"mousemove",this._disableDelayedDrag);e(n,"touchmove",this._disableDelayedDrag);e(n,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(i,u){u=u||("touch"==i.pointerType?i:null);u?(d={target:n,clientX:u.clientX,clientY:u.clientY},this._onDragStart(d,"touch")):this.nativeDraggable?(r(n,"dragend",this),r(t,"dragstart",this._onDragStart)):this._onDragStart(d,!0);try{f.selection?ot(function(){f.selection.empty()}):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(){if(t&&n){var i=this.options;p(n,i.ghostClass,!0);p(n,i.dragClass,!1);h.active=this;l(this,t,"start",n,t,t,y)}else this._nulling()},_emulateDragOver:function(){if(v){if(this._lastX===v.clientX&&this._lastY===v.clientY)return;this._lastX=v.clientX;this._lastY=v.clientY;li||u(i,"display","none");var n=f.elementFromPoint(v.clientX,v.clientY),t=n,r=ft.length;if(n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(v.clientX,v.clientY),t=n),t)do{if(t[g]){for(;r--;)ft[r]({clientX:v.clientX,clientY:v.clientY,target:n,rootEl:t});break}n=t}while(t=t.parentNode);li||u(i,"display","")}},_onTouchMove:function(n){if(d){var f=this.options,e=f.fallbackTolerance,o=f.fallbackOffset,t=n.touches?n.touches[0]:n,s=t.clientX-d.clientX+o.x,c=t.clientY-d.clientY+o.y,r=n.touches?"translate3d("+s+"px,"+c+"px,0)":"translate("+s+"px,"+c+"px)";if(!h.active){if(e&&nr(tt(t.clientX-this._lastX),tt(t.clientY-this._lastY))<e)return;this._dragStarted()}this._appendGhost();ct=!0;v=t;u(i,"webkitTransform",r);u(i,"mozTransform",r);u(i,"msTransform",r);u(i,"transform",r);n.preventDefault()}},_appendGhost:function(){if(!i){var o,r=n.getBoundingClientRect(),s=u(n),e=this.options;i=n.cloneNode(!0);p(i,e.ghostClass,!1);p(i,e.fallbackClass,!0);p(i,e.dragClass,!0);u(i,"top",r.top-hi(s.marginTop,10));u(i,"left",r.left-hi(s.marginLeft,10));u(i,"width",r.width);u(i,"height",r.height);u(i,"opacity","0.8");u(i,"position","fixed");u(i,"zIndex","100000");u(i,"pointerEvents","none");e.fallbackOnBody&&f.body.appendChild(i)||t.appendChild(i);o=i.getBoundingClientRect();u(i,"width",2*r.width-o.width);u(i,"height",2*r.height-o.height)}},_onDragStart:function(i,e){var s=this,c=i.dataTransfer,h=s.options;s._offUpEvents();it.checkPull(s,s,n,i)&&(o=oi(n),o.draggable=!1,o.style["will-change"]="",u(o,"display","none"),p(o,s.options.chosenClass,!1),s._cloneId=ot(function(){t.insertBefore(o,n);l(s,t,"clone",n)}));p(n,h.dragClass,!0);e?("touch"===e?(r(f,"touchmove",s._onTouchMove),r(f,"touchend",s._onDrop),r(f,"touchcancel",s._onDrop),h.supportPointer&&(r(f,"pointermove",s._onTouchMove),r(f,"pointerup",s._onDrop))):(r(f,"mousemove",s._onTouchMove),r(f,"mouseup",s._onDrop)),s._loopId=setInterval(s._emulateDragOver,50)):(c&&(c.effectAllowed="move",h.setData&&h.setData.call(s,c,n)),r(f,"drop",s),s._dragStartId=ot(s._dragStarted))},_onDragOver:function(r){var f,y,c,ft,e=this.el,a=this.options,et=a.group,l=h.active,w=it===et,ot=!1,at=a.sort,d,tt,p;if(void 0!==r.preventDefault&&(!ut&&r.preventDefault(),!a.dragoverBubble&&r.stopPropagation()),!n.animated&&(ct=!0,l&&!a.disabled&&(w?at||(ft=!t.contains(n)):ht===this||(l.lastPullMode=it.checkPull(this,l,n,r))&&et.checkPut(this,l,n,r))&&(void 0===r.rootEl||r.rootEl===this.el))){if(tr(r,a,this.el),gt)return;if(f=b(r.target,a.draggable,e),y=n.getBoundingClientRect(),ht!==this&&(ht=this,ot=!0),ft)return lt(l,!0),s=t,void(o||nt?t.insertBefore(n,o||nt):at||t.appendChild(n));if(0===e.children.length||e.children[0]===i||e===r.target&&wi(e,r)){if(0!==e.children.length&&e.children[0]!==i&&e===r.target&&(f=e.lastElementChild),f){if(f.animated)return;c=f.getBoundingClientRect()}lt(l,w);ii(t,e,n,y,f,c,r)!==!1&&(n.contains(e)||(e.appendChild(n),s=e),this._animate(y,n),f&&this._animate(c,f))}else if(f&&!f.animated&&f!==n&&void 0!==f.parentNode[g]){wt!==f&&(wt=f,st=u(f),bt=u(f.parentNode));c=f.getBoundingClientRect();var ni=c.right-c.left,vt=c.bottom-c.top,yt=di.test(st.cssFloat+st.display)||"flex"==bt.display&&0===bt["flex-direction"].indexOf("row"),pt=f.offsetWidth>n.offsetWidth,kt=f.offsetHeight>n.offsetHeight,dt=(yt?(r.clientX-c.left)/ni:(r.clientY-c.top)/vt)>.5,k=f.nextElementSibling,v=!1;yt?(d=n.offsetTop,tt=f.offsetTop,v=d===tt?f.previousElementSibling===n&&!pt||dt&&pt:f.previousElementSibling===n||n.previousElementSibling===f?(r.clientY-c.top)/vt>.5:tt>d):ot||(v=k!==n&&!kt||dt&&kt);p=ii(t,e,n,y,f,c,r,v);p!==!1&&(1!==p&&p!==-1||(v=1===p),gt=!0,rt(pi,30),lt(l,w),n.contains(e)||(v&&!k?e.appendChild(n):f.parentNode.insertBefore(n,v?k:f)),s=n.parentNode,this._animate(y,n),this._animate(c,f))}}},_animate:function(n,t){var i=this.options.animation,r;i&&(r=t.getBoundingClientRect(),1===n.nodeType&&(n=n.getBoundingClientRect()),u(t,"transition","none"),u(t,"transform","translate3d("+(n.left-r.left)+"px,"+(n.top-r.top)+"px,0)"),t.offsetWidth,u(t,"transition","all "+i+"ms"),u(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=rt(function(){u(t,"transition","");u(t,"transform","");t.animated=!1},i))},_offUpEvents:function(){var n=this.el.ownerDocument;e(f,"touchmove",this._onTouchMove);e(f,"pointermove",this._onTouchMove);e(n,"mouseup",this._onDrop);e(n,"touchend",this._onDrop);e(n,"pointerup",this._onDrop);e(n,"touchcancel",this._onDrop);e(n,"pointercancel",this._onDrop);e(n,"selectstart",this)},_onDrop:function(r){var a=this.el,u=this.options;clearInterval(this._loopId);clearInterval(k.pid);clearTimeout(this._dragStartTimer);at(this._cloneId);at(this._dragStartId);e(f,"mouseover",this);e(f,"mousemove",this._onTouchMove);this.nativeDraggable&&(e(f,"drop",this),e(a,"dragstart",this._onDragStart));this._offUpEvents();r&&(ct&&(!ut&&r.preventDefault(),!u.dropBubble&&r.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),t!==s&&"clone"===h.active.lastPullMode||o&&o.parentNode&&o.parentNode.removeChild(o),n&&(this.nativeDraggable&&e(n,"dragend",this),ri(n),n.style["will-change"]="",p(n,this.options.ghostClass,!1),p(n,this.options.chosenClass,!1),l(this,t,"unchoose",n,s,t,y),t!==s?(c=et(n,u.draggable),c>=0&&(l(null,s,"add",n,s,t,y,c),l(this,t,"remove",n,s,t,y,c),l(null,s,"sort",n,s,t,y,c),l(this,t,"sort",n,s,t,y,c))):n.nextSibling!==nt&&(c=et(n,u.draggable),c>=0&&(l(this,t,"update",n,s,t,y,c),l(this,t,"sort",n,s,t,y,c))),h.active&&(null!=c&&c!==-1||(c=y),l(this,t,"end",n,s,t,y,c),this.save())));this._nulling()},_nulling:function(){t=n=s=i=nt=o=vt=a=yt=d=v=ct=c=wt=st=ht=it=h.active=null;ni.forEach(function(n){n.checked=!0});ni.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragover":case"dragenter":n&&(this._onDragOver(t),yi(t));break;case"mouseover":this._onDrop(t);break;case"selectstart":t.preventDefault()}},toArray:function(){for(var n,i=[],r=this.el.children,t=0,f=r.length,u=this.options;t<f;t++)n=r[t],b(n,u.draggable,this.el)&&i.push(n.getAttribute(u.dataIdAttr)||bi(n));return i},sort:function(n){var t={},i=this.el;this.toArray().forEach(function(n,r){var u=i.children[r];b(u,this.options.draggable,i)&&(t[n]=u)},this);n.forEach(function(n){t[n]&&(i.removeChild(t[n]),i.appendChild(t[n]))})},save:function(){var n=this.options.store;n&&n.set(this)},closest:function(n,t){return b(n,t||this.options.draggable,this.el)},option:function(n,t){var i=this.options;return void 0===t?i[n]:(i[n]=t,void("group"===n&&ai(i)))},destroy:function(){var n=this.el;n[g]=null;e(n,"mousedown",this._onTapStart);e(n,"touchstart",this._onTapStart);e(n,"pointerdown",this._onTapStart);this.nativeDraggable&&(e(n,"dragover",this),e(n,"dragenter",this));Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")});ft.splice(ft.indexOf(this._onDragOver),1);this._onDrop();this.el=n=null}},r(f,"touchmove",function(n){h.active&&n.preventDefault()}),h.utils={on:r,off:e,css:u,find:ti,is:function(n,t){return!!b(n,t,n)},extend:ei,throttle:fi,closest:b,toggleClass:p,clone:oi,index:et,nextTick:ot,cancelNextTick:at},h.create=function(n,t){return new h(n,t)},h.version="1.6.1",h}),function(n){function t(n,i){return new t.prototype.init(n,i)}var u=0,i=!1,r;r=function(n){return this[0]=n.startOffset,this[1]=n.endOffset,this.range=n,this};r.prototype.equals=function(){return this[0]===this[1]};n.fn.redactor=function(i){var r=[],u=Array.prototype.slice.call(arguments,1);return typeof i=="string"?this.each(function(){var t=n.data(this,"redactor"),f;if(typeof t!="undefined"&&n.isFunction(t[i]))f=t[i].apply(t,u),f!==undefined&&f!==t&&r.push(f);else return n.error('No such method "'+i+'" for Redactor')}):this.each(function(){n.data(this,"redactor")||n.data(this,"redactor",t(this,i))}),r.length===0?this:r.length===1?r[0]:r};n.Redactor=t;n.Redactor.VERSION="9.0.2";n.Redactor.opts={initCallback:!1,changeCallback:!1,focusCallback:!1,blurCallback:!1,keydownCallback:!1,keyupCallback:!1,execCommandCallback:!1,pasteBeforeCallback:!1,pasteAfterCallback:!1,autosaveCallback:!1,imageUploadCallback:!1,imageUploadErrorCallback:!1,imageDeleteCallback:!1,fileUploadCallback:!1,fileUploadErrorCallback:!1,rangy:!1,iframe:!1,fullpage:!1,css:!1,lang:"en",direction:"ltr",placeholder:!1,wym:!1,mobile:!0,cleanup:!0,visual:!0,focus:!1,tabindex:!1,autoresize:!0,minHeight:!1,shortcuts:!0,autosave:!1,autosaveInterval:60,plugins:!1,linkAnchor:!1,linkEmail:!1,linkProtocol:"http://",imageGetJson:!1,imageUpload:!1,fileUpload:!1,s3:!1,uploadFields:!1,observeImages:!0,modalOverlay:!0,tabFocus:!0,air:!1,airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],toolbar:!0,toolbarFixed:!1,toolbarFixedTopOffset:0,toolbarFixedBox:!1,toolbarExternal:!1,buttonSource:!0,buttonSeparator:'<li class="redactor_separator"><\/li>',buttonsCustom:{},buttonsAdd:[],buttons:["html","|","formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","image","video","file","table","link","|","fontcolor","backcolor","|","alignment","|","horizontalrule"],colors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify","table"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline",tr:"table",td:"table",table:"table"},activeButtonsAdd:!1,formattingTags:["p","blockquote","pre","h1","h2","h3","h4"],linebreaks:!1,paragraphy:!0,convertDivs:!0,convertLinks:!0,formattingPre:!1,phpTags:!1,allowedTags:!1,deniedTags:["html","head","link","body","meta","script","style","applet"],boldTag:"strong",italicTag:"em",buffer:[],rebuffer:[],textareamode:!1,emptyHtml:"<p>&#x200b;<\/p>",invisibleSpace:"&#x200b;",rBlockTest:/^(P|H[1-6]|LI|ADDRESS|SECTION|HEADER|FOOTER|ASIDE|ARTICLE)$/i,alignmentTags:["H1","H2","H3","H4","H5","H6","P","TD","DIV","BLOCKQUOTE"],ownLine:["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],contOwnLine:["li","dt","dt","h[1-6]","option","script"],newLevel:["blockquote","div","dl","fieldset","form","frameset","map","ol","p","pre","select","td","th","tr","ul"],blockLevelElements:["P","H1","H2","H3","H4","H5","H6","DD","DL","DT","DIV","LI","BLOCKQUOTE","OUTPUT","FIGCAPTION","PRE","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],langs:{en:{html:"HTML",video:"Insert Video",image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",link_edit:"Edit link",unlink:"Unlink",formatting:"Formatting",paragraph:"Normal text",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code",file:"Insert File",upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment",filename:"Name (optional)"}}};t.fn=n.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,TAB:9,CTRL:17,META:91,LEFT:37,LEFT_WIN:91},init:function(t,i){if(this.$element=this.$source=n(t),this.uuid=u++,this.opts=n.extend({},n.Redactor.opts,this.$element.data(),i),this.start=!0,this.dropdowns=[],this.sourceHeight=this.$source.css("height"),this.sourceWidth=this.$source.css("width"),this.opts.fullpage&&(this.opts.iframe=!0),this.opts.linebreaks&&(this.opts.paragraphy=!1),this.opts.paragraphy&&(this.opts.linebreaks=!1),this.opts.toolbarFixedBox&&(this.opts.toolbarFixed=!0),this.document=document,this.window=window,this.savedSel=!1,this.cleanlineBefore=new RegExp("^<(/?"+this.opts.ownLine.join("|/?")+"|"+this.opts.contOwnLine.join("|")+")[ >]"),this.cleanlineAfter=new RegExp("^<(br|/?"+this.opts.ownLine.join("|/?")+"|/"+this.opts.contOwnLine.join("|/")+")[ >]"),this.cleannewLevel=new RegExp("^<\/?("+this.opts.newLevel.join("|")+")[ >]"),this.rTestBlock=new RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i"),this.opts.linebreaks===!1&&(this.opts.allowedTags!==!1&&n.inArray("p",this.opts.allowedTags)==="-1"&&this.opts.allowedTags.push("p"),this.opts.deniedTags!==!1)){var r=n.inArray("p",this.opts.deniedTags);r!=="-1"&&this.opts.deniedTags.splice(r,r)}(this.browser("msie")||this.browser("opera"))&&(this.opts.buttons=this.removeFromArrayByValue(this.opts.buttons,"horizontalrule"));this.opts.curLang=this.opts.langs[this.opts.lang];this.buildStart()},initToolbar:function(n){return{html:{title:n.html,func:"toggle"},formatting:{title:n.formatting,func:"show",dropdown:{p:{title:n.paragraph,func:"formatBlocks"},blockquote:{title:n.quote,func:"formatQuote",className:"redactor_format_blockquote"},pre:{title:n.code,func:"formatBlocks",className:"redactor_format_pre"},h1:{title:n.header1,func:"formatBlocks",className:"redactor_format_h1"},h2:{title:n.header2,func:"formatBlocks",className:"redactor_format_h2"},h3:{title:n.header3,func:"formatBlocks",className:"redactor_format_h3"},h4:{title:n.header4,func:"formatBlocks",className:"redactor_format_h4"}}},bold:{title:n.bold,exec:"bold"},italic:{title:n.italic,exec:"italic"},deleted:{title:n.deleted,exec:"strikethrough"},underline:{title:n.underline,exec:"underline"},unorderedlist:{title:"&bull; "+n.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+n.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+n.outdent,func:"indentingOutdent"},indent:{title:"> "+n.indent,func:"indentingIndent"},image:{title:n.image,func:"imageShow"},video:{title:n.video,func:"videoShow"},file:{title:n.file,func:"fileShow"},table:{title:n.table,func:"show",dropdown:{insert_table:{title:n.insert_table,func:"tableShow"},separator_drop1:{name:"separator"},insert_row_above:{title:n.insert_row_above,func:"tableAddRowAbove"},insert_row_below:{title:n.insert_row_below,func:"tableAddRowBelow"},insert_column_left:{title:n.insert_column_left,func:"tableAddColumnLeft"},insert_column_right:{title:n.insert_column_right,func:"tableAddColumnRight"},separator_drop2:{name:"separator"},add_head:{title:n.add_head,func:"tableAddHead"},delete_head:{title:n.delete_head,func:"tableDeleteHead"},separator_drop3:{name:"separator"},delete_column:{title:n.delete_column,func:"tableDeleteColumn"},delete_row:{title:n.delete_row,func:"tableDeleteRow"},delete_table:{title:n.delete_table,func:"tableDeleteTable"}}},link:{title:n.link,func:"show",dropdown:{link:{title:n.link_insert,func:"linkShow"},unlink:{title:n.unlink,exec:"unlink"}}},fontcolor:{title:n.fontcolor,func:"show"},backcolor:{title:n.backcolor,func:"show"},alignment:{title:n.alignment,func:"show",dropdown:{alignleft:{title:n.align_left,func:"alignmentLeft"},aligncenter:{title:n.align_center,func:"alignmentCenter"},alignright:{title:n.align_right,func:"alignmentRight"},justify:{title:n.align_justify,func:"alignmentJustify"}}},alignleft:{title:n.align_left,func:"alignmentLeft"},aligncenter:{title:n.align_center,func:"alignmentCenter"},alignright:{title:n.align_right,func:"alignmentRight"},justify:{title:n.align_justify,func:"alignmentJustify"},horizontalrule:{exec:"inserthorizontalrule",title:n.horizontalrule}}},callback:function(t,i,r){var u=this.opts[t+"Callback"];return n.isFunction(u)?i===!1?u.call(this,r):u.call(this,i,r):r},destroy:function(){var i,t;clearInterval(this.autosaveInterval);n(window).off(".redactor");this.$element.off(".redactor").removeData("redactor");i=this.get();this.opts.textareamode?(this.$box.after(this.$source),this.$box.remove(),this.$source.val(i).show()):(t=this.$editor,this.opts.iframe&&(t=this.$element),this.$box.after(t),this.$box.remove(),t.removeClass("redactor_editor").removeClass("redactor_editor_wym").removeAttr("contenteditable").html(i).show())},getObject:function(){return n.extend({},this)},getEditor:function(){return this.$editor},getBox:function(){return this.$box},getIframe:function(){return this.opts.iframe?this.$frame:!1},getToolbar:function(){return this.$toolbar},get:function(){return this.$source.val()},getCodeIframe:function(){this.$editor.removeAttr("contenteditable").removeAttr("dir");var n=this.outerHtml(this.$frame.contents().children());return this.$editor.attr({contenteditable:!0,dir:this.opts.direction}),n},set:function(n,t){n=n.toString();this.opts.fullpage?this.setCodeIframe(n):this.setEditor(n,t)},setEditor:function(n,t){t!==!1&&(n=this.cleanSavePreCode(n),n=this.cleanStripTags(n),n=this.cleanConvertProtected(n),n=this.cleanConvertInlineTags(n),n=this.opts.linebreaks===!1?this.cleanConverters(n):n.replace(/<p(.*?)>([\w\W]*?)<\/p>/gi,"$2<br>"));n=this.cleanEmpty(n);this.$editor.html(n);this.sync()},setCodeIframe:function(n){var t=this.iframePage();this.$frame[0].src="about:blank";n=this.cleanConvertProtected(n);n=this.cleanConvertInlineTags(n);n=this.cleanRemoveSpaces(n);t.open();t.write(n);t.close();this.opts.fullpage&&(this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction}));this.sync()},setFullpageOnInit:function(n){n=this.cleanSavePreCode(n,!0);n=this.cleanConverters(n);n=this.cleanEmpty(n);this.$editor.html(n);this.sync()},sync:function(){var t="";this.cleanUnverified();t=this.opts.fullpage?this.getCodeIframe():this.$editor.html();t=this.syncClean(t);t=this.cleanRemoveSpaces(t);t=this.cleanRemoveEmptyTags(t);t=t.replace(/<\/li><(ul|ol)>([\w\W]*?)<\/(ul|ol)>/gi,"<$1>$2<\/$1><\/li>");n.trim(t)==="<br>"&&(t="");t!==""&&(t=this.cleanHtml(t));t=this.callback("syncBefore",!1,t);this.$source.val(t);typeof htmlEncode!="undefined"&&n("#"+this.$element[0].id+"_code").html(htmlEncode(t));this.callback("syncAfter",!1,t);this.start===!1&&this.callback("change",!1,t)},syncClean:function(t){return this.opts.fullpage||(t=this.cleanStripTags(t)),t=n.trim(t),t=this.placeholderRemoveFromCode(t),t=t.replace(/&#x200b;/gi,""),t=t.replace(/&#8203;/gi,""),t=t.replace(/&nbsp;/gi," "),t=t.replace("<!--?php","<?php"),t=t.replace("?-->","?>"),t=t.replace(/<span(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/span>/gi,'<font$1data-redactor="verified"$2>$3<\/font>'),t=t.replace(/<span(.*?)>([\w\W]*?)<\/span>/gi,"$2"),t=t.replace(/<font(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/font>/gi,"<span$1$2>$3<\/span>"),t=t.replace(/<br\s?\/?>\n?<\/(.*?)>/gi,"<\/$1>"),t=t.replace(/<span(.*?)data-redactor-inlineMethods=""(.*?)>([\w\W]*?)<\/span>/gi,"<span$1$2>$3<\/span>"),t=t.replace(/<span\s*?>([\w\W]*?)<\/span>/gi,"$1"),t=t.replace(/<span\s*?id="selection-marker(.*?)"(.*?)>([\w\W]*?)<\/span>/gi,""),this.cleanReConvertProtected(t)},buildStart:function(){this.content="";this.$box=n('<div class="redactor_box" />');this.$source[0].tagName==="TEXTAREA"&&(this.opts.textareamode=!0);this.opts.mobile===!1&&this.isMobile()?this.buildMobile():(this.buildContent(),this.opts.iframe?(this.opts.autoresize=!1,this.iframeStart()):this.opts.textareamode?this.buildFromTextarea():this.buildFromElement(),this.opts.iframe||(this.buildOptions(),this.buildAfter()))},buildMobile:function(){this.opts.textareamode||(this.$editor=this.$source,this.$editor.hide(),this.$source=this.buildCodearea(this.$editor),this.$source.val(this.content));this.$box.insertAfter(this.$source).append(this.$source)},buildContent:function(){this.content=this.opts.textareamode?n.trim(this.$source.val()):n.trim(this.$source.html())},buildFromTextarea:function(){this.$editor=n("<div />");this.$box.insertAfter(this.$source).append(this.$editor).append(this.$source);this.buildAddClasses(this.$editor);this.buildEnable()},buildFromElement:function(){this.$editor=this.$source;this.$source=this.buildCodearea(this.$editor);this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$source);this.buildEnable()},buildCodearea:function(t){return n("<textarea />").attr("name",t.attr("id")).css("height",this.sourceHeight)},buildAddClasses:function(t){n.each(this.$source.get(0).className.split(/\s+/),function(n,i){t.addClass("redactor_"+i)})},buildEnable:function(){this.$editor.addClass("redactor_editor").attr({contenteditable:!0,dir:this.opts.direction});this.$source.attr("dir",this.opts.direction).hide();this.set(this.content)},buildOptions:function(){var n=this.$editor;this.opts.iframe&&(n=this.$frame);this.opts.tabindex&&n.attr("tabindex",this.opts.tabindex);this.opts.minHeight&&n.css("min-height",this.opts.minHeight+"px");this.opts.wym&&this.$editor.addClass("redactor_editor_wym");this.opts.autoresize||n.css("height",this.sourceHeight)},buildAfter:function(){if(this.start=!1,this.opts.toolbar&&(this.opts.toolbar=this.initToolbar(this.opts.curLang),this.toolbarBuild()),this.modalTemplatesInit(),this.buildPlugins(),this.buildBindKeyboard(),this.opts.autosave&&this.autosave(),setTimeout(n.proxy(this.observeStart,this),4),this.browser("mozilla"))try{this.document.execCommand("enableObjectResizing",!1,!1);this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){}this.opts.focus&&setTimeout(n.proxy(this.focus,this),100);this.opts.visual||setTimeout(n.proxy(function(){this.opts.visual=!0;this.toggle(!1)},this),200);this.callback("init")},buildBindKeyboard:function(){var t=!1,r;this.browser("webkit")&&navigator.userAgent.indexOf("Chrome")===-1&&(r=this.browser("version").split("."),r[0]<536&&(t=!0));this.$editor.on("paste.redactor",n.proxy(function(){if(t||this.browser("opera"))return!0;if(this.isMobile()||!this.opts.cleanup)return!1;i=!0;this.selectionSave();this.selectall||(this.opts.autoresize===!0?(this.$editor.height(this.$editor.height()),this.saveScroll=this.document.body.scrollTop):this.saveScroll=this.$editor.scrollTop());var r=this.extractContent();setTimeout(n.proxy(function(){var t=this.extractContent(),n;this.$editor.append(r);this.selectionRestore();n=this.getFragmentHtml(t);this.pasteClean(n);this.opts.autoresize===!0&&this.$editor.css("height","auto")},this),1)},this));this.$editor.on("keydown.redactor",n.proxy(function(t){var c,h,l;if(i)return!1;var u=t.which,o=t.ctrlKey||t.metaKey,f=this.getParent(),r=this.getCurrent(),e=this.getBlock(),s=!1;if(this.callback("keydown",t),(f&&n(f).get(0).tagName==="PRE"||r&&n(r).get(0).tagName==="PRE")&&(s=!0,u===this.keyCode.DOWN&&this.insertAfterLastElement(e)),u===this.keyCode.DOWN&&(f&&n(f).get(0).tagName==="BLOCKQUOTE"&&this.insertAfterLastElement(f),r&&n(r).get(0).tagName==="BLOCKQUOTE"&&this.insertAfterLastElement(r)),o&&!t.shiftKey&&this.shortcuts(t,u),!o||u!==90||t.shiftKey||t.altKey){if(o&&u===90&&t.shiftKey&&!t.altKey){t.preventDefault();this.opts.rebuffer.length!=0?this.bufferRedo():this.document.execCommand("redo",!1,!1);return}}else{t.preventDefault();this.opts.buffer.length?this.bufferUndo():this.document.execCommand("undo",!1,!1);return}if(o&&u===65?this.selectall=!0:u==this.keyCode.LEFT_WIN||o||(this.selectall=!1),u!=this.keyCode.ENTER||t.shiftKey||t.ctrlKey||t.metaKey)u===this.keyCode.ENTER&&(t.ctrlKey||t.shiftKey)&&(this.bufferSet(),t.preventDefault(),this.insertLineBreak());else{if(f.nodeType==1&&(f.tagName=="TD"||f.tagName=="TH"))return this.bufferSet(),this.insertNode(document.createElement("br")),t.preventDefault(),!1;if(s===!0)return this.bufferSet(),t.preventDefault(),c=n(r).parent().text(),this.insertNode(document.createTextNode("\n")),c.search(/\s$/)==-1&&this.insertNode(document.createTextNode("\n")),this.sync(),!1;if(!this.opts.linebreaks)if(e&&this.opts.rBlockTest.test(e.tagName))this.bufferSet(),setTimeout(n.proxy(function(){var t=this.getBlock(),i;t.tagName!=="DIV"||n(t).hasClass("redactor_editor")||(i=n("<p>"+this.opts.invisibleSpace+"<\/p>"),n(t).replaceWith(i),this.selectionStart(i))},this),1);else if(e===!1)return this.bufferSet(),h=n("<p>"+this.opts.invisibleSpace+"<\/p>"),this.insertNode(h[0]),this.selectionStart(h),!1;if(this.opts.linebreaks)if(e&&this.opts.rBlockTest.test(e.tagName))this.bufferSet(),setTimeout(n.proxy(function(){var t=this.getBlock();t.tagName!=="DIV"&&t.tagName!=="P"||n(t).hasClass("redactor_editor")||this.replaceLineBreak(t)},this),1);else{this.bufferSet();this.insertLineBreak();t.preventDefault();return}if(e.tagName=="BLOCKQUOTE"||e.tagName=="FIGCAPTION"){this.bufferSet();this.insertLineBreak();t.preventDefault();return}}if(u===this.keyCode.TAB&&this.opts.shortcuts){if(!this.opts.tabFocus||this.isEmpty(this.get()))return!0;if(t.preventDefault(),s!==!0||t.shiftKey)t.shiftKey?this.indentingOutdent():this.indentingIndent();else return this.bufferSet(),this.insertNode(document.createTextNode("\t")),this.sync(),!1;return!1}u===this.keyCode.BACKSPACE&&typeof r.nodeValue!="undefined"&&r.nodeValue!==null&&(l=n.trim(r.nodeValue.replace(/[^\u0000-~]/g,"")),r.remove&&r.nodeType===3&&r.nodeValue.charCodeAt(0)==8203&&l==""&&r.remove())},this));this.$editor.on("keyup.redactor, input.redactor",n.proxy(function(t){var r,e;if(i)return!1;var u=t.which,o=this.getParent(),f=this.getCurrent();if(this.opts.linebreaks||f.nodeType!=3||o!=!1&&o.tagName!="BODY"||(r=n("<p>").append(n(f).clone()),n(f).replaceWith(r),e=n(r).next(),e[0].tagName=="BR"&&e.remove(),this.selectionEnd(r)),this.opts.convertLinks&&u===this.keyCode.ENTER&&this.formatLinkify(this.opts.linkProtocol),this.opts.linebreaks===!1&&(u===this.keyCode.DELETE||u===this.keyCode.BACKSPACE))return this.formatEmpty(t);this.callback("keyup",t);this.sync()},this));this.$editor.on("blur.redactor",n.proxy(function(){this.$source.trigger("change")},this));if(n.isFunction(this.opts.focusCallback))this.$editor.on("focus.redactor",n.proxy(this.opts.focusCallback,this));if(n.isFunction(this.opts.blurCallback))this.$editor.on("blur.redactor",n.proxy(this.opts.blurCallback,this))},buildPlugins:function(){this.opts.plugins&&n.each(this.opts.plugins,n.proxy(function(t,i){RedactorPlugins[i]&&(n.extend(this,RedactorPlugins[i]),n.isFunction(RedactorPlugins[i].init)&&this.init())},this))},iframeStart:function(){this.iframeCreate();this.opts.textareamode?this.iframeAppend(this.$source):(this.$sourceOld=this.$source.hide(),this.$source=this.buildCodearea(this.$sourceOld),this.iframeAppend(this.$sourceOld))},iframeAppend:function(n){this.$source.attr("dir",this.opts.direction).hide();this.$box.insertAfter(n).append(this.$frame).append(this.$source)},iframeCreate:function(){this.$frame=n('<iframe style="width: 100%;" frameborder="0" />').one("load",n.proxy(function(){if(this.opts.fullpage){this.iframePage();this.content===""&&(this.content=this.opts.invisibleSpace);this.$frame.contents()[0].write(this.content);this.$frame.contents()[0].close();var t=setInterval(n.proxy(function(){this.$frame.contents().find("body").html()&&(clearInterval(t),this.iframeLoad())},this),0)}else this.iframeLoad()},this))},iframeDoc:function(){return this.$frame[0].contentWindow.document},iframePage:function(){var n=this.iframeDoc();return n.documentElement&&n.removeChild(n.documentElement),n},iframeAddCss:function(t){t=t||this.opts.css;this.isString(t)&&this.$frame.contents().find("head").append('<link rel="stylesheet" href="'+t+'" />');n.isArray(t)&&n.each(t,n.proxy(function(n,t){this.iframeAddCss(t)},this))},iframeLoad:function(){this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction});this.$editor[0]&&(this.document=this.$editor[0].ownerDocument,this.window=this.document.defaultView||window);this.iframeAddCss();this.opts.fullpage?this.setFullpageOnInit(this.$editor.html()):this.set(this.content);this.buildOptions();this.buildAfter()},placeholderStart:function(t){if(this.isEmpty(t)&&(this.$element.attr("placeholder")&&(this.opts.placeholder=this.$element.attr("placeholder")),this.opts.placeholder===""&&(this.opts.placeholder=!1),this.opts.placeholder!==!1)){this.opts.focus=!1;this.$editor.one("focus.redactor_placeholder",n.proxy(this.placeholderFocus,this));return n('<span class="redactor_placeholder" data-redactor="verified">').attr("contenteditable",!1).text(this.opts.placeholder)}return!1},placeholderFocus:function(){this.$editor.find("span.redactor_placeholder").remove();var n="";this.opts.linebreaks===!1&&(n=this.opts.emptyHtml);this.$editor.off("focus.redactor_placeholder");this.$editor.html(n);this.opts.linebreaks===!1&&this.selectionStart(this.$editor.children()[0]);this.sync()},placeholderRemove:function(){this.opts.placeholder=!1;this.$editor.find("span.redactor_placeholder").remove();this.$editor.off("focus.redactor_placeholder")},placeholderRemoveFromCode:function(n){return n.replace(/<span class="redactor_placeholder"(.*?)>(.*?)<\/span>/i,"")},shortcuts:function(n,t){this.opts.shortcuts&&(n.altKey?t===48?this.shortcutsLoadFormat(n,"p"):t===49?this.shortcutsLoadFormat(n,"h1"):t===50?this.shortcutsLoadFormat(n,"h2"):t===51?this.shortcutsLoadFormat(n,"h3"):t===52?this.shortcutsLoadFormat(n,"h4"):t===53?this.shortcutsLoadFormat(n,"h5"):t===54&&this.shortcutsLoadFormat(n,"h6"):t===77?this.shortcutsLoad(n,"removeFormat"):t===66?this.shortcutsLoad(n,"bold"):t===73?this.shortcutsLoad(n,"italic"):t===74?this.shortcutsLoad(n,"insertunorderedlist"):t===75?this.shortcutsLoad(n,"insertorderedlist"):t===72?this.shortcutsLoad(n,"superscript"):t===76&&this.shortcutsLoad(n,"subscript"))},shortcutsLoad:function(n,t){n.preventDefault();this.execCommand(t,!1)},shortcutsLoadFormat:function(n,t){n.preventDefault();this.formatBlocks(t)},focus:function(){this.browser("opera")?this.$editor.focus():this.window.setTimeout(n.proxy(this.focusSet,this,!0),1)},focusEnd:function(){this.focusSet()},focusSet:function(n){var t,i;this.$editor.focus();t=this.getRange();t.selectNodeContents(this.$editor[0]);t.collapse(n||!1);i=this.getSelection();i.removeAllRanges();i.addRange(t)},toggle:function(t){var i,r;if(this.opts.visual){t!==!1&&this.selectionSave();r=null;this.opts.iframe?(r=this.$frame.height(),this.opts.fullpage&&this.$editor.removeAttr("contenteditable"),this.$frame.hide()):(r=this.$editor.innerHeight(),this.$editor.hide());i=this.$source.val();this.modified=i;this.$source.height(r).show().focus();this.$source.on("keydown.redactor-textarea",function(t){if(t.keyCode===9){var i=n(this),r=i.get(0).selectionStart;return i.val(i.val().substring(0,r)+"\t"+i.val().substring(i.get(0).selectionEnd)),i.get(0).selectionStart=i.get(0).selectionEnd=r+1,!1}});this.buttonInactiveVisual();this.buttonActive("html");this.opts.visual=!1}else i=this.$source.hide().val(),typeof this.modified!="undefined"&&(this.modified=this.cleanRemoveSpaces(this.modified,!1)!==this.cleanRemoveSpaces(i,!1)),this.modified&&(this.opts.fullpage&&i===""?this.setFullpageOnInit(i):(this.set(i),this.opts.fullpage&&this.buildBindKeyboard())),this.opts.iframe?this.$frame.show():this.$editor.show(),this.opts.fullpage&&this.$editor.attr("contenteditable",!0),this.$source.off("keydown.redactor-textarea"),this.$editor.focus(),this.selectionRestore(),this.observeStart(),this.buttonActiveVisual(),this.buttonInactive("html"),this.opts.visual=!0},autosave:function(){var t=!1;this.autosaveInterval=setInterval(n.proxy(function(){var i=this.get();t!==i&&n.ajax({url:this.opts.autosave,type:"post",data:this.$source.attr("name")+"="+escape(encodeURIComponent(i)),success:n.proxy(function(n){this.callback("autosave",!1,n);t=i},this)})},this),this.opts.autosaveInterval*1e3)},toolbarBuild:function(){var t,i,r;if(this.opts.air?this.opts.buttons=this.opts.airButtons:this.opts.buttonSource||(t=this.opts.buttons.indexOf("html"),i=this.opts.buttons[t+1],this.opts.buttons.splice(t,1),i==="|"&&this.opts.buttons.splice(t,1)),n.extend(this.opts.toolbar,this.opts.buttonsCustom),n.each(this.opts.buttonsAdd,n.proxy(function(n,t){this.opts.buttons.push(t)},this)),this.opts.toolbar&&n.each(this.opts.toolbar.formatting.dropdown,n.proxy(function(t){n.inArray(t,this.opts.formattingTags)=="-1"&&delete this.opts.toolbar.formatting.dropdown[t]},this)),this.opts.buttons.length===0)return!1;if(this.airEnable(),this.$toolbar=n("<ul>").addClass("redactor_toolbar").attr("id","redactor_toolbar_"+this.uuid),this.opts.air?(this.$air=n('<div class="redactor_air">').attr("id","redactor_air_"+this.uuid).hide(),this.$air.append(this.$toolbar),n("body").append(this.$air)):this.opts.toolbarExternal?n(this.opts.toolbarExternal).html(this.$toolbar):this.$box.prepend(this.$toolbar),n.each(this.opts.buttons,n.proxy(function(t,i){if(i==="|")this.$toolbar.append(n(this.opts.buttonSeparator));else if(this.opts.toolbar[i]){var r=this.opts.toolbar[i];if(this.opts.fileUpload===!1&&i==="file")return!0;this.$toolbar.append(n("<li>").append(this.buttonBuild(i,r)))}},this)),this.$toolbar.find("a").attr("tabindex","-1"),this.opts.toolbarFixed){this.toolbarObserveScroll();n(document).on("scroll.redactor",n.proxy(this.toolbarObserveScroll,this))}if(this.opts.activeButtons){r=n.proxy(this.buttonActiveObserver,this);this.$editor.on("mouseup.redactor keyup.redactor",r)}},toolbarObserveScroll:function(){var r=n(this.document).scrollTop(),u=this.$box.offset().top,t=0,f=u+this.$box.height()+40,i;r>u?(i="100%",this.opts.toolbarFixedBox&&(t=this.$box.offset().left,i=this.$box.innerWidth(),this.$toolbar.addClass("toolbar_fixed_box")),this.toolbarFixed=!0,this.$toolbar.css({position:"fixed",width:i,zIndex:1005,top:this.opts.toolbarFixedTopOffset+"px",left:t}),r<f?this.$toolbar.css("visibility","visible"):this.$toolbar.css("visibility","hidden")):(this.toolbarFixed=!1,this.$toolbar.css({position:"relative",width:"auto",top:0,left:t}),this.opts.toolbarFixedBox&&this.$toolbar.removeClass("toolbar_fixed_box"))},airEnable:function(){if(this.opts.air)this.$editor.on("mouseup.redactor keyup.redactor",this,n.proxy(function(t){var u=this.getSelectionText(),i,r;t.type==="mouseup"&&u!=""&&this.airShow(t);t.type==="keyup"&&t.shiftKey&&u!=""&&(i=n(this.getElement(this.getSelection().focusNode)),r=i.offset(),r.height=i.height(),this.airShow(r,!0))},this))},airShow:function(t,i){var r,u,f;this.opts.air&&(n(".redactor_air").hide(),i?(r=t.left,u=t.top+t.height+14,this.opts.iframe&&(u+=this.$box.position().top-n(this.document).scrollTop(),r+=this.$box.position().left)):(f=this.$air.innerWidth(),r=t.clientX,n(this.document).width()<r+f&&(r-=f),u=t.clientY+14,this.opts.iframe?(u+=this.$box.position().top,r+=this.$box.position().left):u+=n(this.document).scrollTop()),this.$air.css({left:r+"px",top:u+"px"}).show(),this.airBindHide())},airBindHide:function(){if(this.opts.air){var t=n.proxy(function(t){n(t).on("mousedown.redactor",n.proxy(function(i){n(i.target).closest(this.$toolbar).length===0&&(this.$air.fadeOut(100),this.selectionRemove(),n(t).off(i))},this)).on("keydown.redactor",n.proxy(function(i){i.which===this.keyCode.ESC&&this.getSelection().collapseToStart();this.$air.fadeOut(100);n(t).off(i)},this))},this);t(document);this.opts.iframe&&t(this.document)}},airBindMousemoveHide:function(){if(this.opts.air){var t=n.proxy(function(t){n(t).on("mousemove.redactor",n.proxy(function(i){n(i.target).closest(this.$toolbar).length===0&&(this.$air.fadeOut(100),n(t).off(i))},this))},this);t(document);this.opts.iframe&&t(this.document)}},pickerBuild:function(t,i){var r,s,f,u,e,o,h;for(t.width(210),r="color",i==="backcolor"&&(r="background-color"),s=this.opts.colors.length,f=this,u=0;u<s;u++){e=this.opts.colors[u];o=n('<a rel="'+e+'" href="javascript:;" class="redactor_color_link"><\/a>').css({backgroundColor:e});t.append(o);o.on("click",function(){var t=n(this).attr("rel");i==="backcolor"&&(t=n(this).css("background-color"));f.pickerSet(r,t)})}h=n('<a href="javascript:;" class="redactor_color_none"><\/a>').html(this.opts.curLang.none).on("click",function(){f.pickerSet(r,!1)});t.append(h)},pickerSet:function(n,t){this.bufferSet();this.$editor.focus();this.inlineRemoveStyle(n);t!==!1&&this.inlineSetStyle(n,t);this.opts.air&&this.$air.fadeOut(100);this.sync()},dropdownBuild:function(t,i){n.each(i,n.proxy(function(i,r){r.className||(r.className="");var u;if(r.name==="separator")u=n('<a class="redactor_separator_drop">');else{u=n('<a href="javascript:;" class="'+r.className+" redactor_dropdown_"+i+'">'+r.title+"<\/a>");u.on("click",n.proxy(function(n){n.preventDefault&&n.preventDefault();this.browser("msie")&&(n.returnValue=!1);r.callback&&r.callback.call(this,i,u,r,n);r.exec&&this.execCommand(r.exec,i);r.func&&this[r.func](i);this.buttonActiveObserver();this.opts.air&&this.$air.fadeOut(100)},this))}t.append(u)},this))},dropdownShow:function(t,i,r){var e;if(!this.opts.visual)return t.preventDefault(),!1;if(this.buttonGet(r).hasClass("dropact"))this.dropdownHideAll();else{this.dropdownHideAll();this.buttonActive(r);this.buttonGet(r).addClass("dropact");var o=this.buttonGet(r).position(),u=o.left+"px",f=29;this.opts.air?i.css({position:"absolute",left:u,top:f+"px"}).show():this.opts.toolbarFixed&&this.toolbarFixed?i.css({position:"fixed",left:u,top:f+"px"}).show():i.css({position:"absolute",left:u,top:o.top+f+"px"}).show()}e=n.proxy(function(n){this.dropdownHide(n,i)},this);n(document).one("click",e);this.$editor.one("click",e);t.stopPropagation()},dropdownHideAll:function(){this.$toolbar.find("a.dropact").removeClass("redactor_act").removeClass("dropact");n(".redactor_dropdown").hide()},dropdownHide:function(t,i){n(t.target).hasClass("dropact")||(i.removeClass("dropact"),this.dropdownHideAll())},buttonBuild:function(t,i){var r=n('<a href="javascript:;" title="'+i.title+'" class="redactor_btn redactor_btn_'+t+'"><\/a>'),u=n('<div class="redactor_dropdown" style="display: none;">');r.on("click",n.proxy(function(n){if(n.preventDefault&&n.preventDefault(),this.browser("msie")&&(n.returnValue=!1),r.hasClass("redactor_button_disabled"))return!1;this.isFocused()===!1&&this.$editor.focus();i.exec?(this.execCommand(i.exec,t),this.airBindMousemoveHide()):i.func&&i.func!=="show"?(this[i.func](t),this.airBindMousemoveHide()):i.callback?(i.callback.call(this,t,r,i,n),this.airBindMousemoveHide()):(t==="backcolor"||t==="fontcolor"||i.dropdown)&&this.dropdownShow(n,u,t);this.buttonActiveObserver(!1,t)},this));return(t==="backcolor"||t==="fontcolor"||i.dropdown)&&(u.appendTo(this.$toolbar),t==="backcolor"||t==="fontcolor"?this.pickerBuild(u,t):this.dropdownBuild(u,i.dropdown)),r},buttonGet:function(t){return this.opts.toolbar?n(this.$toolbar.find("a.redactor_btn_"+t)):!1},buttonActiveToggle:function(n){var t=this.buttonGet(n);t.hasClass("redactor_act")?t.removeClass("redactor_act"):t.addClass("redactor_act")},buttonActive:function(n){this.buttonGet(n).addClass("redactor_act")},buttonInactive:function(n){this.buttonGet(n).removeClass("redactor_act")},buttonInactiveAll:function(t){n.each(this.opts.activeButtons,n.proxy(function(n,i){i!=t&&this.buttonInactive(i)},this))},buttonActiveVisual:function(){this.$toolbar.find("a.redactor_btn").not("a.redactor_btn_html").removeClass("redactor_button_disabled")},buttonInactiveVisual:function(){this.$toolbar.find("a.redactor_btn").not("a.redactor_btn_html").addClass("redactor_button_disabled")},buttonChangeIcon:function(n,t){this.buttonGet(n).addClass("redactor_btn_"+t)},buttonRemoveIcon:function(n,t){this.buttonGet(n).removeClass("redactor_btn_"+t)},buttonAddSeparator:function(){this.$toolbar.append(n(this.opts.buttonSeparator))},buttonAddSeparatorAfter:function(t){this.buttonGet(t).parent().after(n(this.opts.buttonSeparator))},buttonAddSeparatorBefore:function(t){this.buttonGet(t).parent().before(n(this.opts.buttonSeparator))},buttonRemoveSeparatorAfter:function(n){this.buttonGet(n).parent().next().remove()},buttonRemoveSeparatorBefore:function(n){this.buttonGet(n).parent().prev().remove()},buttonSetRight:function(n){this.opts.toolbar&&this.buttonGet(n).parent().addClass("redactor_btn_right")},buttonSetLeft:function(n){this.opts.toolbar&&this.buttonGet(n).parent().removeClass("redactor_btn_right")},buttonAdd:function(t,i,r,u){if(this.opts.toolbar){var f=this.buttonBuild(t,{title:i,callback:r,dropdown:u});this.$toolbar.append(n("<li>").append(f))}},buttonAddFirst:function(t,i,r,u){if(this.opts.toolbar){var f=this.buttonBuild(t,{title:i,callback:r,dropdown:u});this.$toolbar.prepend(n("<li>").append(f))}},buttonAddAfter:function(t,i,r,u,f){if(this.opts.toolbar){var e=this.buttonBuild(i,{title:r,callback:u,dropdown:f}),o=this.buttonGet(t);o.parent().after(n("<li>").append(e))}},buttonAddBefore:function(t,i,r,u,f){if(this.opts.toolbar){var e=this.buttonBuild(i,{title:r,callback:u,dropdown:f}),o=this.buttonGet(t);o.parent().before(n("<li>").append(e))}},buttonRemove:function(n,t){var i=this.buttonGet(n);t&&i.parent().next().remove();i.parent().removeClass("redactor_btn_right");i.remove()},buttonActiveObserver:function(t,i){var r=this.getParent(),u,f;if(this.buttonInactiveAll(i),t===!1){this.buttonActiveToggle(i);return}if(r&&r.tagName==="A"?this.$toolbar.find("a.redactor_dropdown_link").text(this.opts.curLang.link_edit):this.$toolbar.find("a.redactor_dropdown_link").text(this.opts.curLang.link_insert),this.opts.activeButtonsAdd&&(n.each(this.opts.activeButtonsAdd,n.proxy(function(n,t){this.opts.activeButtons.push(t)},this)),n.extend(this.opts.activeButtonsStates,this.opts.activeButtonsAdd)),n.each(this.opts.activeButtonsStates,n.proxy(function(t,i){n(r).closest(t,this.$editor.get()[0]).length!=0&&this.buttonActive(i)},this)),u=n(r).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]),u.length){f=u.css("text-align");switch(f){case"right":this.buttonActive("alignright");break;case"center":this.buttonActive("aligncenter");break;case"justify":this.buttonActive("justify");break;default:this.buttonActive("alignleft")}}},exec:function(n,t,i){n==="formatblock"&&this.browser("msie")&&(t="<"+t+">");n==="inserthtml"&&this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(t)):this.document.execCommand(n,!1,t);i!==!1&&this.sync();this.callback("execCommand",n,t)},execCommand:function(t,i,r){var f,o,l,h,a,e,s,u;if(!this.opts.visual)return this.$source.focus(),!1;if(t==="inserthtml"){this.insertHtml(i,r);this.callback("execCommand",t,i);return}if(this.currentOrParentIs("PRE")&&!this.opts.formattingPre)return!1;if(t==="insertunorderedlist"||t==="insertorderedlist"){var u=this.getParent(),e=n(u).closest("ol, ul"),c=!1;e.length&&(c=!0,f=e[0].tagName,(t==="insertunorderedlist"&&f==="OL"||t==="insertorderedlist"&&f==="UL")&&(c=!1));this.bufferSet();this.selectionSave();c?(o=this.getNodes(),l=this.getBlocks(o),typeof o[0]!="undefined"&&o.length>1&&o[0].nodeType==3&&l.unshift(this.getBlock()),h="",a="",n.each(l,n.proxy(function(t,i){if(i.tagName=="LI"){var r=n(i),u=r.clone();u.find("ul","ol").remove();h+=this.opts.linebreaks===!1?this.outerHtml(n("<p>").append(u.contents())):u.html()+"<br>";t==0?(r.addClass("redactor-replaced").empty(),a=this.outerHtml(r)):r.remove()}},this)),html=this.$editor.html().replace(a,"<\/"+f+">"+h+"<"+f+">"),this.$editor.html(html),this.$editor.find(f+":empty").remove(),this.selectionRestore()):(this.document.execCommand(t),u=this.getParent(),e=n(u).parents("ol, ul"),e.length&&((this.browser("msie")||this.browser("mozilla"))&&u.tagName!=="LI"&&n(u).replaceWith(n(u).html()),s=e.parent(),this.isParentRedactor(s)&&this.nodeTestBlocks(s[0])&&s.replaceWith(s.contents())),this.browser("mozilla")&&this.$editor.focus(),this.selectionRestore());this.sync();this.callback("execCommand",t,i);return}if(t==="unlink"&&(this.bufferSet(),u=this.getParent(),n(u)[0].tagName==="A")){n(u).replaceWith(n(u).text());this.sync();this.callback("execCommand",t,i);return}this.exec(t,i,r);t==="inserthorizontalrule"&&this.$editor.find("hr").removeAttr("id")},indentingIndent:function(){this.indentingStart("indent")},indentingOutdent:function(){this.indentingStart("outdent")},indentingStart:function(t){var i,r,u;if(t==="indent"){if(i=this.getBlock(),i&&i.tagName=="LI"){this.selectionSave();var f=this.getParent(),e=n(f).closest("ol, ul"),o=e[0].tagName,r=this.getBlocks();n.each(r,function(t,i){var r,u;i.tagName=="LI"&&(r=n(i).prev(),r.size()!=0&&r[0].tagName=="LI"&&(u=r.children("ul, ol"),u.size()==0?r.append(n("<"+o+">").append(i)):u.append(i)))});this.selectionRestore()}}else this.selectionSave(),i=this.getBlock(),i&&i.tagName=="LI"&&(r=this.getBlocks(),u=0,this.insideOutdent(i,u,r)),this.selectionRestore()},insideOutdent:function(t,i,r){if(t&&t.tagName=="LI"){var u=n(t).parent().parent();u.size()!=0&&u[0].tagName=="LI"?u.after(t):typeof r[i]!="undefined"?(t=r[i],i++,this.insideOutdent(t,i,r)):this.execCommand("insertunorderedlist")}},cleanEmpty:function(n){var t=this.placeholderStart(n);return t!==!1?t:(this.opts.linebreaks===!1&&(n===""?n=this.opts.emptyHtml:n.search(/^<hr\s?\/?>$/gi)!==-1&&(n="<hr>"+this.opts.emptyHtml)),n)},cleanConverters:function(n){return this.opts.convertDivs&&(n=n.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2<\/p>")),this.opts.paragraphy&&(n=this.cleanParagraphy(n)),n},cleanConvertProtected:function(n){return n=n.replace(/<script(.*?)>([\w\W]*?)<\/script>/gi,'<title type="text/javascript" style="display: none;" class="redactor-script-tag"$1>$2<\/title>'),n=n.replace(/<style(.*?)>([\w\W]*?)<\/style>/gi,'<section$1 style="display: none;" rel="redactor-style-tag">$2<\/section>'),n=n.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2<\/section>'),this.opts.phpTags?n.replace(/<\?php([\w\W]*?)\?>/gi,'<section style="display: none;" rel="redactor-php-tag">$1<\/section>'):n.replace(/<\?php([\w\W]*?)\?>/gi,"")},cleanReConvertProtected:function(n){return n=n.replace(/<title type="text\/javascript" style="display: none;" class="redactor-script-tag"(.*?)>([\w\W]*?)<\/title>/gi,'<script$1 type="text/javascript">$2<\/script>'),n=n.replace(/<section(.*?) style="display: none;" rel="redactor-style-tag">([\w\W]*?)<\/section>/gi,"<style$1>$2<\/style>"),n=n.replace(/<section(.*?)rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3<\/form>"),this.opts.phpTags&&(n=n.replace(/<section style="display: none;" rel="redactor-php-tag">([\w\W]*?)<\/section>/gi,"<?php\r\n$1\r\n?>")),n},cleanRemoveSpaces:function(t,i){if(i!==!1){var i=[],u=0,r;r=t.match(/<(pre|style|script|title)(.*?)>([\w\W]*?)<\/(pre|style|script|title)>/gi);r!==null&&n.each(r,function(n,r){u=n;t=t.replace(r,"buffer_"+u);i.push(r)});this.opts.phpTags&&(r=t.match(/<\?php([\w\W]*?)\?>/gi),r!==null&&n.each(r,function(n,r){u=u+n;t=t.replace(r,"buffer_"+n);i.push(r)}))}return t=t.replace(/\n/g," "),t=t.replace(/[\t]*/g,""),t=t.replace(/\n\s*\n/g,"\n"),t=t.replace(/^[\s\n]*/g," "),t=t.replace(/[\s\n]*$/g," "),t=t.replace(/>\s{2,}</g,"><"),i!==!1&&(t=this.cleanReplacer(i,t)),t=t.replace(/\n\n/g,"\n")},cleanReplacer:function(t,i){return t&&n.each(t,function(n,t){i=i.replace("buffer_"+n,t)}),i},cleanRemoveEmptyTags:function(n){var i,r,t;for(n=n.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),n=n.replace(/[\u200B-\u200D\uFEFF]/g,""),i=["<pre><\/pre>","<blockquote>\\s*<\/blockquote>","<dd><\/dd>","<dt><\/dt>","<em>\\s*<\/em>","<ul><\/ul>","<ol><\/ol>","<li><\/li>","<table><\/table>","<tr><\/tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*<\/b>","<b>&nbsp;<\/b>","<p>\\s*<\/p>","<p><\/p>","<p>&nbsp;<\/p>","<p>\\s*<br>\\s*<\/p>","<div>\\s*<\/div>","<div>\\s*<br>\\s*<\/div>"],r=i.length,t=0;t<r;++t)n=n.replace(new RegExp(i[t],"gi"),"");return n},cleanParagraphy:function(t){function i(n,i,r){return t.replace(new RegExp(n,i),r)}var o,r,u,f,e;if(t=n.trim(t),this.opts.linebreaks===!0)return t;if(t===""||t==="<p><\/p>")return this.opts.emptyHtml;t=t+"\n";o=[];r=0;t.search(/<(table|div|pre|object)/gi)!==-1&&n.each(t.match(/<(table|div|pre|object)(.*?)>([\w\W]*?)<\/(table|div|pre|object)>/gi),function(n,i){r++;o[r]=i;t=t.replace(i,"{replace"+r+"}\n")});this.opts.phpTags&&t.search(/<section(.*?)rel="redactor-php-tag">/gi)!==-1&&n.each(t.match(/<section(.*?)rel="redactor-php-tag">([\w\W]*?)<\/section>/gi),function(n,i){r++;o[r]=i;t=t.replace(i,"{replace"+r+"}\n")});t=t.replace(/<\!\-\-([\w\W]*?)\-\->/gi,"<comment>$1<\/comment>");t=t.replace(/<br \/>\s*<br \/>/gi,"\n\n");u="(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)";t=i("(<"+u+"[^>]*>)","gi","\n$1");t=i("(<\/"+u+">)","gi","$1\n\n");t=i("\r\n","g","\n");t=i("\r","g","\n");t=i("/\n\n+/","g","\n\n");f=t.split(new RegExp("\ns*\n","g"),-1);t="";for(e in f)f.hasOwnProperty(e)&&(t+=f[e].search("{replace")==-1?"<p>"+f[e].replace(/^\n+|\n+$/g,"")+"<\/p>":f[e]);return t.search(/<blockquote/gi)!==-1&&n.each(t.match(/<blockquote(.*?)>([\w\W]*?)<\/blockquote>/gi),function(n,i){var r="";r=i.replace("<p>","");r=r.replace("<\/p>","<br>");t=t.replace(i,r)}),t=i("<p>s*<\/p>","gi",""),t=i("<p>([^<]+)<\/(div|address|form)>","gi","<p>$1<\/p><\/$2>"),t=i("<p>s*(<\/?"+u+"[^>]*>)s*<\/p>","gi","$1"),t=i("<p>(<li.+?)<\/p>","gi","$1"),t=i("<p>s*(<\/?"+u+"[^>]*>)","gi","$1"),t=i("(<\/?"+u+"[^>]*>)s*<\/p>","gi","$1"),t=i("(<\/?"+u+"[^>]*>)s*<br />","gi","$1"),t=i("<br />(s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","gi","$1"),t=i("\n<\/p>","gi","<\/p>"),t=i("<\/li><p>","gi","<\/li>"),t=i("<\/ul><p>(.*?)<\/li>","gi","<\/ul><\/li>"),t=i("<\/ol><p>","gi","<\/ol>"),t=i("<p>\t?\n?<p>","gi","<p>"),t=i("<\/dt><p>","gi","<\/dt>"),t=i("<\/dd><p>","gi","<\/dd>"),t=i("<br><\/p><\/blockquote>","gi","<\/blockquote>"),n.each(o,function(n,i){t=t.replace("{replace"+n+"}",i)}),t=t.replace(/<comment>([\w\W]*?)<\/comment>/gi,"<!--$1-->"),n.trim(t)},cleanConvertInlineTags:function(n){var i="strong",t;return this.opts.boldTag==="b"&&(i="b"),t="em",this.opts.italicTag==="i"&&(t="i"),n=n.replace(/<span style="font-style: italic;">([\w\W]*?)<\/span>/gi,"<"+t+">$1<\/"+t+">"),n=n.replace(/<span style="font-weight: bold;">([\w\W]*?)<\/span>/gi,"<"+i+">$1<\/"+i+">"),n=this.opts.boldTag==="strong"?n.replace(/<b>([\w\W]*?)<\/b>/gi,"<strong>$1<\/strong>"):n.replace(/<strong>([\w\W]*?)<\/strong>/gi,"<b>$1<\/b>"),n=this.opts.italicTag==="em"?n.replace(/<i>([\w\W]*?)<\/i>/gi,"<em>$1<\/em>"):n.replace(/<em>([\w\W]*?)<\/em>/gi,"<i>$1<\/i>"),n=n.replace(/<strike>([\w\W]*?)<\/strike>/gi,"<del>$1<\/del>"),/<span(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/span>/gi.test(n)||(n=n.replace(/<span(.*?)(?!data-redactor="verified")(.*?)>([\w\W]*?)<\/span>/gi,'<span$1 data-redactor="verified"$2>$3<\/span>')),n},cleanStripTags:function(t){var i,r,u;return t==""||typeof t=="undefined"?t:(i=!1,this.opts.allowedTags!==!1&&(i=!0),r=i===!0?this.opts.allowedTags:this.opts.deniedTags,u=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,t=t.replace(u,function(t,u){return i===!0?n.inArray(u.toLowerCase(),r)>"-1"?t:"":n.inArray(u.toLowerCase(),r)>"-1"?"":t}),this.cleanConvertInlineTags(t))},cleanSavePreCode:function(t,i){var r=t.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/gi);return r!==null&&n.each(r,n.proxy(function(n,r){var u=r.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/i);u[3]=u[3].replace(/&nbsp;/g," ");i!==!1&&(u[3]=this.cleanEncodeEntities(u[3]));t=t.replace(r,"<"+u[1]+u[2]+">"+u[3]+"<\/"+u[1]+">")},this)),t},cleanEncodeEntities:function(n){return n=String(n).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},cleanUnverified:function(){var t=this.$editor.find("img, a, b, strong, sub, sup, i, em, u, small, strike, del, span, cite");t.filter('[style*="font-size"][style*="line-height"]').css("font-size","").css("line-height","");t.filter('[style*="background-color: transparent;"][style*="line-height"]').css("background-color","").css("line-height","");t.filter('[style*="background-color: transparent;"]').css("background-color","");n.each(t,n.proxy(function(n,t){this.removeEmptyAttr(t,"style")},this));this.$editor.find('div[style="text-align: -webkit-auto;"]').contents().unwrap()},cleanHtml:function(n){var u=0,h=n.length,i=0,e=null,o=null,r="",t="",f="",s;for(this.cleanlevel=0;u<h;u++){if(i=u,-1==n.substr(u).indexOf("<"))return t+=n.substr(u),this.cleanFinish(t);while(i<h&&n.charAt(i)!="<")i++;for(u!=i&&(f=n.substr(u,i-u),f.match(/^\s{2,}$/g)||("\n"==t.charAt(t.length-1)?t+=this.cleanGetTabs():"\n"==f.charAt(0)&&(t+="\n"+this.cleanGetTabs(),f=f.replace(/^\s+/,"")),t+=f),f.match(/\n/)&&(t+="\n"+this.cleanGetTabs())),e=i;i<h&&">"!=n.charAt(i);)i++;if(r=n.substr(e,i-e),u=i,"!--"==r.substr(1,3)){if(!r.match(/--$/)){while("-->"!=n.substr(i,3))i++;i+=2;r=n.substr(e,i-e);u=i}"\n"!=t.charAt(t.length-1)&&(t+="\n");t+=this.cleanGetTabs();t+=r+">\n"}else"!"==r[1]?t=this.placeTag(r+">",t):"?"==r[1]?t+=r+">\n":(s=r.match(/^<(script|style|pre)/i))?(s[1]=s[1].toLowerCase(),r=this.cleanTag(r),t=this.placeTag(r,t),o=String(n.substr(u+1)).toLowerCase().indexOf("<\/"+s[1]),o&&(f=n.substr(u+1,o),u+=o,t+=f)):(r=this.cleanTag(r),t=this.placeTag(r,t))}return this.cleanFinish(t)},cleanGetTabs:function(){for(var n="",t=0;t<this.cleanlevel;t++)n+="\t";return n},cleanFinish:function(n){return n=n.replace(/\n\s*\n/g,"\n"),n=n.replace(/^[\s\n]*/,""),n=n.replace(/[\s\n]*$/,""),n=n.replace(/<script(.*?)>\n<\/script>/gi,"<script$1><\/script>"),this.cleanlevel=0,n},cleanTag:function(n){var i="",r,t;for(n=n.replace(/\n/g," "),n=n.replace(/\s{2,}/g," "),n=n.replace(/^\s+|\s+$/g," "),r="",n.match(/\/$/)&&(r="/",n=n.replace(/\/+$/,""));t=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(n);)t[2]?i+=t[1].toLowerCase()+"="+t[2]:t[1]&&(i+=t[1].toLowerCase()),i+=" ",n=n.substr(t[0].length);return i.replace(/\s*$/,"")+r+">"},placeTag:function(n,t){var i=n.match(this.cleannewLevel);return(n.match(this.cleanlineBefore)||i)&&(t=t.replace(/\s*$/,"")+"\n"),i&&"/"==n.charAt(1)&&this.cleanlevel--,"\n"==t.charAt(t.length-1)&&(t+=this.cleanGetTabs()),i&&"/"!=n.charAt(1)&&this.cleanlevel++,t+=n,(n.match(this.cleanlineAfter)||n.match(this.cleannewLevel))&&(t=t.replace(/ *$/,"")+"\n"),t},alignmentLeft:function(){this.alignmentSet("","JustifyLeft")},alignmentRight:function(){this.alignmentSet("right","JustifyRight")},alignmentCenter:function(){this.alignmentSet("center","JustifyCenter")},alignmentJustify:function(){this.alignmentSet("justify","JustifyFull")},alignmentSet:function(t,i){if(this.bufferSet(),this.oldIE())return this.document.execCommand(i,!1,!1),!0;this.selectionSave();var r=this.getBlocks();n.each(r,n.proxy(function(i,r){var u=!1;u=n.inArray(r.tagName,this.opts.alignmentTags)!==-1?n(r):n(r).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]);u&&(u.css("text-align",t),this.removeEmptyAttr(u,"style"))},this));this.selectionRestore();this.sync()},formatEmpty:function(t){var i=n.trim(this.$editor.html()),r,u;i=i.replace(/<br\s?\/?>/i,"");r=i.replace(/<p>\s?<\/p>/gi,"");(i===""||r==="")&&(t.preventDefault(),u=n(this.opts.emptyHtml).get(0),this.$editor.html(u),this.focus());this.sync()},formatBlocks:function(t){this.bufferSet();var i=this.getBlocks();this.selectionSave();n.each(i,n.proxy(function(n,i){i.tagName!=="LI"&&this.formatBlock(t,i)},this));this.selectionRestore();this.sync()},formatBlock:function(t,i){var r,u;if(i===!1&&(i=this.getBlock()),i===!1)return this.opts.linebreaks===!0&&this.execCommand("formatblock",t),!0;r="";t!=="pre"?r=n(i).contents():(r=n(i).html(),n.trim(r)===""&&(r='<span id="selection-marker-1"><\/span>'));i.tagName==="PRE"&&(t="p");this.opts.linebreaks===!0&&t==="p"?n(i).replaceWith(n("<div>").append(r).html()+"<br>"):(u=n("<"+t+">").append(r),n(i).replaceWith(u))},formatChangeTag:function(t,i,r){r!==!1&&this.selectionSave();var u=n("<"+i+"/>");return n(t).replaceWith(function(){return u.append(n(this).contents())}),r!==!1&&this.selectionRestore(),u},formatQuote:function(){var u,i,f,e;if(this.bufferSet(),this.opts.linebreaks===!1)this.selectionSave(),u=this.getBlocks(),u&&n.each(u,n.proxy(function(n,t){t.tagName==="BLOCKQUOTE"?this.formatBlock("p",t,!1):t.tagName!=="LI"&&this.formatBlock("blockquote",t,!1)},this)),this.selectionRestore();else if(i=this.getBlock(),i.tagName==="BLOCKQUOTE")this.selectionSave(),n(i).replaceWith(n(i).html()+"<br>"),this.selectionRestore();else{var r=this.selectionWrap("blockquote"),t=n(r).html();n.each(["ul","ol","table","tr","tbody","thead","tfoot","dl"],function(n,i){t=t.replace(new RegExp("<"+i+"(.*?)>","gi"),"");t=t.replace(new RegExp("<\/"+i+">","gi"),"")});f=this.opts.blockLevelElements;f.push("td");n.each(f,function(n,i){t=t.replace(new RegExp("<"+i+"(.*?)>","gi"),"");t=t.replace(new RegExp("<\/"+i+">","gi"),"<br>")});n(r).html(t);this.selectionElement(r);e=n(r).next();e[0].tagName==="BR"&&e.remove()}this.sync()},blockRemoveAttr:function(t){var i=this.getBlocks();n(i).removeAttr(t);this.sync()},blockSetAttr:function(t,i){var r=this.getBlocks();n(r).attr(t,i);this.sync()},blockRemoveStyle:function(t){var i=this.getBlocks();n(i).css(t,"");this.removeEmptyAttr(i,"style");this.sync()},blockSetStyle:function(t,i){var r=this.getBlocks();n(r).css(t,i);this.sync()},blockRemoveClass:function(t){var i=this.getBlocks();n(i).removeClass(t);this.removeEmptyAttr(i,"class");this.sync()},blockSetClass:function(t){var i=this.getBlocks();n(i).addClass(t);this.sync()},inlineRemoveClass:function(t){this.selectionSave();this.inlineEachNodes(function(i){n(i).removeClass(t);this.removeEmptyAttr(i,"class")});this.selectionRestore();this.sync()},inlineSetClass:function(t){var i=this.getCurrent();n(i).hasClass(t)||this.inlineMethods("addClass",t)},inlineRemoveStyle:function(t){this.selectionSave();this.inlineEachNodes(function(i){n(i).css(t,"");this.removeEmptyAttr(i,"style")});this.selectionRestore();this.sync()},inlineSetStyle:function(n,t){this.inlineMethods("css",n,t)},inlineRemoveAttr:function(t){this.selectionSave();var i=this.getRange(),r=this.getElement(),u=this.getNodes();(i.collapsed||i.startContainer===i.endContainer&&r)&&(u=n(r));n(u).removeAttr(t);this.inlineUnwrapSpan();this.selectionRestore();this.sync()},inlineSetAttr:function(n,t){this.inlineMethods("attr",n,t)},inlineMethods:function(t,i,r){var u,f,e;this.selectionSave();u=this.getRange();f=this.getElement();u.collapsed||u.startContainer===u.endContainer&&f?n(f)[t](i,r):(this.document.execCommand("fontSize",!1,4),e=this.$editor.find("font"),n.each(e,n.proxy(function(n,u){this.inlineSetMethods(t,u,i,r)},this)));this.selectionRestore();this.sync()},inlineSetMethods:function(t,i,r,u){var e=n(i).parent(),f;return e&&e[0].tagName==="SPAN"?(f=e,n(i).replaceWith(n(i).html())):(f=n('<span data-redactor="verified" data-redactor-inlineMethods>').append(n(i).contents()),n(i).replaceWith(f)),n(f)[t](r,u),f},inlineEachNodes:function(t){var i=this.getRange(),r=this.getElement(),u=this.getNodes(),f;(i.collapsed||i.startContainer===i.endContainer&&r)&&(u=n(r),f=!0);n.each(u,n.proxy(function(i,r){if(!f&&r.tagName!=="SPAN"){if(r.parentNode.tagName!=="SPAN"||n(r.parentNode).hasClass("redactor_editor"))return;r=r.parentNode}t.call(this,r)},this))},inlineUnwrapSpan:function(){var t=this.$editor.find("span[data-redactor-inlineMethods]");n.each(t,n.proxy(function(t,i){var r=n(i);r.attr("class")===undefined&&r.attr("style")===undefined&&r.contents().unwrap()},this))},inlineFormat:function(t){this.selectionSave();this.document.execCommand("fontSize",!1,4);var i=this.$editor.find("font"),r;n.each(i,function(i,u){var f=n("<"+t+"/>").append(n(u).contents());n(u).replaceWith(f);r=f});this.selectionRestore();this.sync()},inlineRemoveFormat:function(t){this.selectionSave();var i=t.toUpperCase(),r=this.getNodes();n.each(r,function(t,r){r.tagName===i&&n(r).replaceWith(n(r).contents())});this.selectionRestore();this.sync()},insertHtml:function(t,i){var e=this.getCurrent(),o=e.parentNode,r,u,f;this.$editor.focus();this.bufferSet();r=n("<div>").append(n.parseHTML(t));t=r.html();t=this.cleanRemoveEmptyTags(t);r=n("<div>").append(n.parseHTML(t));u=this.getBlock();r.contents().length==1&&(f=r.contents()[0].tagName,(f!="P"&&f==u.tagName||f=="PRE")&&(t=r.text(),r=n("<div>").append(t)));!this.opts.linebreaks&&r.contents().length==1&&r.contents()[0].nodeType==3&&(this.getRangeSelectedNodes().length>2||!e||e.tagName=="BODY"&&!o||o.tagName=="HTML")&&(t="<p>"+t+"<\/p>");u.tagName=="BLOCKQUOTE"&&t.indexOf("<a")===-1?this.insertText(t):r.contents().length>1&&u||r.contents().is("p, :header, ul, ol, div, table, blockquote, pre, address, section, header, footer, aside, article")?this.browser("msie")?this.document.selection.createRange().pasteHTML(t):this.document.execCommand("inserthtml",!1,t):this.insertHtmlAdvanced(t);this.selectall&&this.window.setTimeout(n.proxy(function(){this.opts.linebreaks?this.focusEnd():this.selectionEnd(this.$editor.contents().last())},this),1);this.observeStart();i!==!1&&this.sync()},insertHtmlAdvanced:function(n){var i=this.getSelection(),t,r,u,e,f;if(i.getRangeAt&&i.rangeCount){for(t=i.getRangeAt(0),t.deleteContents(),r=this.document.createElement("div"),r.innerHTML=n,u=this.document.createDocumentFragment();e=r.firstChild;)f=u.appendChild(e);t.insertNode(u);f&&(t=t.cloneRange(),t.setStartAfter(f),t.collapse(!0),i.removeAllRanges(),i.addRange(t))}},insertText:function(t){var i=n(n.parseHTML(t));i.length&&(t=i.text());this.$editor.focus();this.browser("msie")?this.document.selection.createRange().pasteHTML(t):this.document.execCommand("inserthtml",!1,t);this.sync()},insertNode:function(n){n=n[0]||n;var t=this.getSelection();t.getRangeAt&&t.rangeCount&&(range=t.getRangeAt(0),range.deleteContents(),range.insertNode(n),range.setEndAfter(n),range.setStartAfter(n),t.removeAllRanges(),t.addRange(range))},insertAfterLastElement:function(t){var i;if(this.isEndOfElement()){if(this.$editor.contents().last()[0]!==t)return!1;this.bufferSet();this.opts.linebreaks===!1?(i=n(this.opts.emptyHtml),n(t).after(i),this.selectionStart(i)):(i=n('<span id="selection-marker-1">'+this.opts.invisibleSpace+"<\/span>",this.document)[0],n(t).after(i),n(i).after(this.opts.invisibleSpace),this.selectionRestore())}},insertLineBreak:function(){this.selectionSave();this.$editor.find("#selection-marker-1").before("<br>"+(this.browser("webkit")?this.opts.invisibleSpace:""));this.selectionRestore()},insertDoubleLineBreak:function(){this.selectionSave();this.$editor.find("#selection-marker-1").before("<br><br>"+(this.browser("webkit")?this.opts.invisibleSpace:""));this.selectionRestore()},replaceLineBreak:function(t){var i=n("<br>"+this.opts.invisibleSpace);n(t).replaceWith(i);this.selectionStart(i)},pasteClean:function(n){if(n=this.callback("pasteBefore",!1,n),this.currentOrParentIs("PRE"))return n=this.pastePre(n),this.pasteInsert(n),!0;if(n=n.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),n=n.replace(/(&nbsp;){2,}/gi,"&nbsp;"),n=n.replace(/&nbsp;/gi," "),n=n.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),n=this.cleanStripTags(n),n=n.replace(/<td><\/td>/gi,"[td]"),n=n.replace(/<td>&nbsp;<\/td>/gi,"[td]"),n=n.replace(/<td><br><\/td>/gi,"[td]"),n=n.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),n=n.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,"[iframe$1]$2[/iframe]"),n=n.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,"[video$1]$2[/video]"),n=n.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,"[audio$1]$2[/audio]"),n=n.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,"[embed$1]$2[/embed]"),n=n.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,"[object$1]$2[/object]"),n=n.replace(/<param(.*?)>/gi,"[param$1]"),n=n.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,"[img$1$3]"),n=n.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>"),n=n.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),n=n.replace(/<div>\s*?\t*?\n*?(<ul>|<ol>|<p>)/gi,"$1"),n=n.replace(/\[td\]/gi,"<td>&nbsp;<\/td>"),n=n.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2<\/a>'),n=n.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2<\/iframe>"),n=n.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,"<video$1>$2<\/video>"),n=n.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2<\/audio>"),n=n.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2<\/embed>"),n=n.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2<\/object>"),n=n.replace(/\[param(.*?)\]/gi,"<param$1>"),n=n.replace(/\[img(.*?)\]/gi,"<img$1>"),this.opts.convertDivs&&(n=n.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2<\/p>"),n=n.replace(/<\/div><p>/gi,"<p>"),n=n.replace(/<\/p><\/div>/gi,"<\/p>")),n=this.cleanParagraphy(n),n=n.replace(/<span(.*?)>([\w\W]*?)<\/span>/gi,"$2"),n=n.replace(/<img>/gi,""),n=n.replace(/<[^\/>][^>][^img|param|source]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),n=n.replace(/\n{3,}/gi,"\n"),n=n.replace(/<p><p>/gi,"<p>"),n=n.replace(/<\/p><\/p>/gi,"<\/p>"),n=n.replace(/<li>(\s*|\t*|\n*)<p>/gi,"<li>"),n=n.replace(/<\/p>(\s*|\t*|\n*)<\/li>/gi,"<\/li>"),this.opts.linebreaks===!0&&(n=n.replace(/<p(.*?)>([\w\W]*?)<\/p>/gi,"$2<br>")),n=n.replace(/<[^\/>][^>][^img|param|source]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),this.browser("mozilla"))while(/<br>$/gi.test(n))n=n.replace(/<br>$/gi,"");while(/<font>([\w\W]*?)<\/font>/gi.test(n))n=n.replace(/<font>([\w\W]*?)<\/font>/gi,"$1");this.pasteInsert(n)},pastePre:function(n){n=n.replace(/<br>|<\/H[1-6]>|<\/p>|<\/div>/gi,"\n");var t=this.document.createElement("div");return t.innerHTML=n,this.cleanEncodeEntities(t.textContent||t.innerText)},pasteInsert:function(t){this.selectall&&(this.opts.linebreaks?this.$editor.html(""):this.$editor.html(this.opts.emptyHtml),this.$editor.focus());t=this.callback("pasteAfter",!1,t);this.insertHtml(t);this.selectall=!1;setTimeout(function(){i=!1},100);this.opts.autoresize?n(this.document.body).scrollTop(this.saveScroll):this.$editor.scrollTop(this.saveScroll)},bufferSet:function(n){n!==undefined?this.opts.buffer.push(n):(this.selectionSave(),this.opts.buffer.push(this.$editor.html()),this.selectionRemoveMarkers(!0))},bufferUndo:function(){if(this.opts.buffer.length===0){this.$editor.focus();return}this.selectionSave();this.opts.rebuffer.push(this.$editor.html());this.selectionRestore(!1,!0);this.$editor.html(this.opts.buffer.pop());this.selectionRestore();setTimeout(n.proxy(this.observeStart,this),100)},bufferRedo:function(){if(this.opts.rebuffer.length===0)return this.$editor.focus(),!1;this.selectionSave();this.opts.buffer.push(this.$editor.html());this.selectionRestore(!1,!0);this.$editor.html(this.opts.rebuffer.pop());this.selectionRestore(!0);setTimeout(n.proxy(this.observeStart,this),4)},observeStart:function(){this.observeImages();this.observeTables()},observeTables:function(){this.$editor.find("table").on("click",n.proxy(this.tableObserver,this))},observeImages:function(){if(this.opts.observeImages===!1)return!1;this.$editor.find("img").each(n.proxy(function(t,i){this.browser("msie")&&n(i).attr("unselectable","on");this.imageResize(i)},this))},getSelection:function(){return this.opts.rangy?this.opts.iframe?rangy.getSelection(this.$frame[0]):rangy.getSelection():this.document.getSelection()},getRange:function(){if(this.opts.rangy)return this.opts.iframe?rangy.createRange(this.iframeDoc()):rangy.createRange();if(this.document.getSelection){var n=this.document.getSelection();if(n.getRangeAt&&n.rangeCount)return n.getRangeAt(0)}return this.document.createRange()},selectionElement:function(n){this.setCaret(n)},selectionStart:function(n){this.selectionSet(n[0]||n,0,null,0)},selectionEnd:function(n){this.selectionSet(n[0]||n,1,null,1)},selectionSet:function(n,t,i,r){var u,f;if(i==null&&(i=n),r==null&&(r=t),u=this.getSelection(),u){f=this.getRange();f.setStart(n,t);f.setEnd(i,r);try{u.removeAllRanges()}catch(e){}u.addRange(f)}},selectionWrap:function(n){var i,t;if(n=n.toLowerCase(),i=this.getBlock(),i)return t=this.formatChangeTag(i,n),this.sync(),t;var u=this.getSelection(),r=u.getRangeAt(0),t=document.createElement(n);return t.appendChild(r.extractContents()),r.insertNode(t),this.selectionElement(t),t},selectionAll:function(){var t=this.getRange(),n;t.selectNodeContents(this.$editor[0]);n=this.getSelection();n.removeAllRanges();n.addRange(t)},selectionRemove:function(){this.getSelection().removeAllRanges()},getCaretOffset:function(t){var i=this.getSelection().getRangeAt(0),r=i.cloneRange();return r.selectNodeContents(t),r.setEnd(i.endContainer,i.endOffset),n.trim(r.toString()).length},getCaretOffsetRange:function(){return new r(this.getSelection().getRangeAt(0))},setCaret:function(n,t,i){var r,h,o,c;typeof i=="undefined"&&(i=t);n=n[0]||n;r=this.getRange();r.selectNodeContents(n);var u=this.getTextNodesIn(n),s=!1,f=0,e;if(u.length==1&&t)r.setStart(u[0],t),r.setEnd(u[0],i);else for(h=0;o=u[h++];){if(e=f+o.length,!s&&t>=f&&(t<e||t==e&&h<u.length)&&(r.setStart(o,t-f),s=!0),s&&i<=e){r.setEnd(o,i-f);break}f=e}c=this.getSelection();c.removeAllRanges();c.addRange(r)},getTextNodesIn:function(n){var t=[],r,i,u;if(n.nodeType==3)t.push(n);else for(r=n.childNodes,i=0,u=r.length;i<u;++i)t.push.apply(t,this.getTextNodesIn(r[i]));return t},selectionSave:function(){this.isFocused()||this.$editor.focus();this.opts.rangy?this.savedSel=rangy.saveSelection():this.selectionCreateMarker(this.getRange())},selectionCreateMarker:function(t){if(t){var i=n('<span id="selection-marker-1">'+this.opts.invisibleSpace+"<\/span>",this.document)[0],r=n('<span id="selection-marker-2">'+this.opts.invisibleSpace+"<\/span>",this.document)[0];t.collapsed===!0?this.selectionSetMarker(t,i,!0):(this.selectionSetMarker(t,i,!0),this.selectionSetMarker(t,r,!1));this.savedSel=this.$editor.html();this.selectionRestore(!1,!1)}},selectionSetMarker:function(n,t,i){var r=n.cloneRange();r.collapse(i);r.insertNode(t);r.detach()},selectionRestore:function(n,t){if(this.opts.rangy)rangy.restoreSelection(this.savedSel);else{n===!0&&this.savedSel&&this.$editor.html(this.savedSel);var i=this.$editor.find("span#selection-marker-1"),r=this.$editor.find("span#selection-marker-2");this.isFocused()||this.$editor.focus();i.length!=0&&r.length!=0?this.selectionSet(i[0],0,r[0],0):i.length!=0&&this.selectionSet(i[0],0,null,0);t!==!1&&(this.selectionRemoveMarkers(),this.savedSel=!1)}},selectionRemoveMarkers:function(){this.opts.rangy?rangy.removeMarkers(this.savedSel):(this.$editor.find("span#selection-marker-1").remove(),this.$editor.find("span#selection-marker-2").remove())},getCurrent:function(){var n=!1,t=this.getSelection();return t.rangeCount>0&&(n=t.getRangeAt(0).startContainer),this.isParentRedactor(n)},getParent:function(t){return t=t||this.getCurrent(),t?this.isParentRedactor(n(t).parent()[0]):!1},getBlock:function(t){for(typeof t=="undefined"&&(t=this.getCurrent());t;){if(this.nodeTestBlocks(t))return n(t).hasClass("redactor_editor")?!1:t;t=t.parentNode}return!1},getBlocks:function(t){var i=[],r,t;if(typeof t=="undefined"){if(r=this.getRange(),r&&r.collapsed===!0)return[this.getBlock()];t=this.getNodes(r)}return n.each(t,n.proxy(function(t,r){if(this.opts.iframe===!1&&n(r).parents("div.redactor_editor").size()==0)return!1;this.nodeTestBlocks(r)&&i.push(r)},this)),i.length===0&&(i=[this.getBlock()]),i},nodeTestBlocks:function(n){return n.nodeType==1&&this.rTestBlock.test(n.nodeName)},tagTestBlock:function(n){return this.rTestBlock.test(n)},getSelectedNodes:function(n){var n,u,f,r,e,t,i,o;if((typeof n=="undefined"||n==!1)&&(n=this.getRange()),n&&n.collapsed===!0)return[this.getCurrent()];u=this.getSelection();try{f=u.getRangeAt(0).cloneContents()}catch(s){return!1}for(r=this.document.createElement("span"),r.appendChild(f),window.selnodes=r.childNodes,e=selnodes.length,t=[],i=0,o=e;i<o;i++)t.push(selnodes[i]);return t.length==0&&t.push(this.getCurrent()),t},getNodes:function(t,i){var t,r;if(this.opts.linebreaks)return this.getSelectedNodes(t);if((typeof t=="undefined"||t==!1)&&(t=this.getRange()),t&&t.collapsed===!0)return typeof i=="undefined"&&this.tagTestBlock(i)?(r=this.getBlock(),r.tagName==i?[r]:[]):[this.getCurrent()];var f=[],u=[],e=this.document.getSelection();if(e.isCollapsed||(f=this.getRangeSelectedNodes(e.getRangeAt(0))),n.each(f,n.proxy(function(t,r){if(this.opts.iframe===!1&&n(r).parents("div.redactor_editor").size()==0)return!1;typeof i=="undefined"?n.trim(r.textContent)!=""&&u.push(r):r.tagName==i&&u.push(r)},this)),u.length==0){if(typeof i=="undefined"&&this.tagTestBlock(i))return r=this.getBlock(),r.tagName==i?u.push(r):[];u.push(this.getCurrent())}return u},getElement:function(t){for(t||(t=this.getCurrent());t;){if(t.nodeType==1)return n(t).hasClass("redactor_editor")?!1:t;t=t.parentNode}return!1},getRangeSelectedNodes:function(n){var t,r,i;if(n=n||this.getRange(),t=n.startContainer,r=n.endContainer,t==r)return[t];for(i=[];t&&t!=r;)i.push(t=this.nextNode(t));for(t=n.startContainer;t&&t!=n.commonAncestorContainer;)i.unshift(t),t=t.parentNode;return i},nextNode:function(n){if(n.hasChildNodes())return n.firstChild;while(n&&!n.nextSibling)n=n.parentNode;return n?n.nextSibling:null},getSelectionText:function(){return this.getSelection().toString()},getSelectionHtml:function(){var r="",t=this.getSelection(),i,u,n;if(t.rangeCount){for(i=this.document.createElement("div"),u=t.rangeCount,n=0;n<u;++n)i.appendChild(t.getRangeAt(n).cloneContents());r=i.innerHTML}return this.syncClean(r)},tableShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.table,this.opts.modal_table,300,n.proxy(function(){n("#redactor_insert_table_btn").click(n.proxy(this.tableInsert,this));setTimeout(function(){n("#redactor_table_rows").focus()},200)},this))},tableInsert:function(){for(var l=n("#redactor_table_rows").val(),a=n("#redactor_table_columns").val(),s=n("<div><\/div>"),h=Math.floor(Math.random()*99999),c=n('<table id="table'+h+'"><tbody><\/tbody><\/table>'),r,i,u,f,e,o,t=0;t<l;t++){for(r=n("<tr><\/tr>"),i=0;i<a;i++)u=n("<td>"+this.opts.invisibleSpace+"<\/td>"),t===0&&i===0&&u.append('<span id="selection-marker-1">'+this.opts.invisibleSpace+"<\/span>"),n(r).append(u);c.append(r)}s.append(c);f=s.html();this.modalClose();this.selectionRestore();e=this.getBlock()||this.getCurrent();e?n(e).after(f):this.insertHtmlAdvanced(f);this.selectionRestore();o=this.$editor.find("#table"+h);this.tableObserver(o);this.buttonActiveObserver();o.removeAttr("id");this.sync()},tableObserver:function(t){this.$table=n(t.target||t).closest("table");this.$tbody=n(t.target).closest("tbody");this.$thead=this.$table.find("thead");this.$current_td=n(t.target||this.$table.find("td").first());this.$current_tr=n(t.target||this.$table.find("tr").first()).closest("tr")},tableDeleteTable:function(){(this.bufferSet(),this.$table)&&(this.$table.remove(),this.$table=!1,this.sync())},tableDeleteRow:function(){var n,t;(this.bufferSet(),this.$current_tr)&&(n=this.$current_tr.prev().length?this.$current_tr.prev():this.$current_tr.next(),n.length&&(t=n.children("td").first(),t.length&&(t.prepend('<span id="selection-marker-1">'+this.opts.invisibleSpace+"<\/span>"),this.selectionRestore())),this.$current_tr.remove(),this.sync())},tableDeleteColumn:function(){this.bufferSet();var t=this.$current_td.get(0).cellIndex;this.$table.find("tr").each(n.proxy(function(i,r){var u=t-1<0?t+1:t-1;i===0&&(n(r).find("td").eq(u).prepend('<span id="selection-marker-1">'+this.opts.invisibleSpace+"<\/span>"),this.selectionRestore());n(r).find("td").eq(t).remove()},this));this.sync()},tableAddHead:function(){if(this.bufferSet(),this.$table.find("thead").size()!==0)this.tableDeleteHead();else{var t=this.$table.find("tr").first().clone();t.find("td").html(this.opts.invisibleSpace);this.$thead=n("<thead><\/thead>");this.$thead.append(t);this.$table.prepend(this.$thead);this.sync()}},tableDeleteHead:function(){this.bufferSet();n(this.$thead).remove();this.$thead=!1;this.sync()},tableAddRowAbove:function(){this.tableAddRow("before")},tableAddRowBelow:function(){this.tableAddRow("after")},tableAddColumnLeft:function(){this.tableAddColumn("before")},tableAddColumnRight:function(){this.tableAddColumn("after")},tableAddRow:function(n){this.bufferSet();var t=this.$current_tr.clone();t.find("td").html(this.opts.invisibleSpace);n==="after"?this.$current_tr.after(t):this.$current_tr.before(t);this.sync()},tableAddColumn:function(t){this.bufferSet();var i=0;this.$current_tr.find("td").each(n.proxy(function(t,r){n(r)[0]===this.$current_td[0]&&(i=t)},this));this.$table.find("tr").each(n.proxy(function(r,u){var f=n(u).find("td").eq(i),e=f.clone();e.html(this.opts.invisibleSpace);t==="after"?f.after(e):f.before(e)},this));this.sync()},videoShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.video,this.opts.modal_video,600,n.proxy(function(){n("#redactor_insert_video_btn").click(n.proxy(this.videoInsert,this));setTimeout(function(){n("#redactor_insert_video_area").focus()},200)},this))},videoInsert:function(){var t=n("#redactor_insert_video_area").val(),i;t=this.cleanStripTags(t);this.selectionRestore();i=this.getBlock()||this.getCurrent();i?(n(i).after(t),this.sync()):this.insertHtmlAdvanced(t);this.modalClose()},linkShow:function(){this.selectionSave();var t=n.proxy(function(){this.insert_link_node=!1;var s=this.getSelection(),i="",u="",e="",t=this.getParent(),f=n(t).parent().get(0);f&&f.tagName==="A"&&(t=f);t&&t.tagName==="A"?(i=t.href,u=n(t).text(),e=t.target,this.insert_link_node=t):u=s.toString();n(".redactor_link_text").val(u);var h=self.location.href.replace(/\/$/i,""),r=i.replace(h,""),o=n("#redactor_tabs").find("a");this.opts.linkEmail===!1&&o.eq(1).remove();this.opts.linkAnchor===!1&&o.eq(2).remove();this.opts.linkEmail===!1&&this.opts.linkAnchor===!1?(n("#redactor_tabs").remove(),n("#redactor_link_url").val(r)):i.search("mailto:")===0?(this.modalSetTab.call(this,2),n("#redactor_tab_selected").val(2),n("#redactor_link_mailto").val(i.replace("mailto:",""))):r.search(/^#/gi)===0?(this.modalSetTab.call(this,3),n("#redactor_tab_selected").val(3),n("#redactor_link_anchor").val(r.replace(/^#/gi,""))):n("#redactor_link_url").val(r);e==="_blank"&&n("#redactor_link_blank").prop("checked",!0);n("#redactor_insert_link_btn").click(n.proxy(this.linkProcess,this));setTimeout(function(){n("#redactor_link_url").focus()},200)},this);this.modalInit(this.opts.curLang.link,this.opts.modal_link,460,t)},linkProcess:function(){var r=n("#redactor_tab_selected").val(),t="",i="",u="",f="";if(r==="1"){t=n("#redactor_link_url").val();i=n("#redactor_link_url_text").val();n("#redactor_link_blank").prop("checked")&&(u=' target="_blank"',f="_blank");var e="((xn--)?[a-z0-9]+(-[a-z0-9]+)*.)+[a-z]{2,}",o=new RegExp("^(http|ftp|https)://"+e,"i"),s=new RegExp("^"+e,"i");t.search(o)==-1&&t.search(s)==0&&this.opts.linkProtocol&&(t=this.opts.linkProtocol+t)}else r==="2"?(t="mailto:"+n("#redactor_link_mailto").val(),i=n("#redactor_link_mailto_text").val()):r==="3"&&(t="#"+n("#redactor_link_anchor").val(),i=n("#redactor_link_anchor_text").val());this.linkInsert('<a href="'+t+'"'+u+">"+i+"<\/a>",n.trim(i),t,f)},linkInsert:function(t,i,r,u){this.selectionRestore();i!==""&&(this.insert_link_node?(this.bufferSet(),n(this.insert_link_node).text(i).attr("href",r),u!==""?n(this.insert_link_node).attr("target",u):n(this.insert_link_node).removeAttr("target"),this.sync()):this.exec("inserthtml",t));this.modalClose()},fileShow:function(){this.selectionSave();var t=n.proxy(function(){var t=this.getSelection(),i="";i=this.oldIE()?t.text:t.toString();n("#redactor_filename").val(i);this.isMobile()||this.draguploadInit("#redactor_file",{url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:n.proxy(this.fileCallback,this),error:n.proxy(function(n,t){this.callback("fileUploadError",t)},this)});this.uploadInit("redactor_file",{auto:!0,url:this.opts.fileUpload,success:n.proxy(this.fileCallback,this),error:n.proxy(function(n,t){this.callback("fileUploadError",t)},this)})},this);this.modalInit(this.opts.curLang.file,this.opts.modal_file,500,t)},fileCallback:function(t){var r,u,i;this.selectionRestore();t!==!1&&(r=n("#redactor_filename").val(),r===""&&(r=t.filename),u='<a href="'+t.filelink+'" id="filelink-marker">'+r+"<\/a>",this.browser("webkit")&&!!this.window.chrome&&(u=u+"&nbsp;"),this.execCommand("inserthtml",u,!1),i=n(this.$editor.find("a#filelink-marker")),i.size()!=0?i.removeAttr("id"):i=!1,this.sync(),this.callback("fileUpload",i,t));this.modalClose()},imageShow:function(){this.selectionSave();var t=n.proxy(function(){if(this.opts.imageGetJson?n.getJSON(this.opts.imageGetJson,n.proxy(function(t){var i={},f=0,r,e,u;n.each(t,n.proxy(function(n,t){typeof t.folder!="undefined"&&(f++,i[t.folder]=f)},this));r=!1;n.each(t,n.proxy(function(t,u){var o="",f,e;typeof u.title!="undefined"&&(o=u.title);f=0;n.isEmptyObject(i)||typeof u.folder=="undefined"||(f=i[u.folder],r===!1&&(r=".redactorfolder"+f));e=n('<img src="'+u.thumb+'" class="redactorfolder redactorfolder'+f+'" rel="'+u.image+'" title="'+o+'" />');n("#redactor_image_box").append(e);n(e).click(n.proxy(this.imageThumbClick,this))},this));n.isEmptyObject(i)||(n(".redactorfolder").hide(),n(r).show(),e=function(t){n(".redactorfolder").hide();n(".redactorfolder"+n(t.target).val()).show()},u=n('<select id="redactor_image_box_select">'),n.each(i,function(t,i){u.append(n('<option value="'+i+'">'+t+"<\/option>"))}),n("#redactor_image_box").before(u),u.change(e))},this)):n("#redactor_tabs").find("a").eq(1).remove(),this.opts.imageUpload||this.opts.s3)if(this.isMobile()||this.opts.s3!==!1||n("#redactor_file").length&&this.draguploadInit("#redactor_file",{url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:n.proxy(this.imageCallback,this),error:n.proxy(function(n,t){this.callback("imageUploadError",t)},this)}),this.opts.s3===!1)this.uploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,success:n.proxy(this.imageCallback,this),error:n.proxy(function(n,t){this.callback("imageUploadError",t)},this)});else n("#redactor_file").on("change.redactor",n.proxy(this.s3handleFileSelect,this));else if(n(".redactor_tab").hide(),this.opts.imageGetJson){var t=n("#redactor_tabs").find("a");t.eq(0).remove();t.eq(1).addClass("redactor_tabs_act");n("#redactor_tab2").show()}else n("#redactor_tabs").remove(),n("#redactor_tab3").show();n("#redactor_upload_btn").click(n.proxy(this.imageCallbackLink,this));this.opts.imageUpload||this.opts.imageGetJson||setTimeout(function(){n("#redactor_file_link").focus()},200)},this);this.modalInit(this.opts.curLang.image,this.opts.modal_image,610,t)},imageEdit:function(t){var i=n(t.target),r=i.parent(),u=n.proxy(function(){n("#redactor_file_alt").val(i.attr("alt"));n("#redactor_image_edit_src").attr("href",i.attr("src"));n("#redactor_form_image_align").val(i.css("float"));n(r).get(0).tagName==="A"&&n("#redactor_file_link").val(n(r).attr("href"));n("#redactor_image_delete_btn").click(n.proxy(function(){this.imageRemove(i)},this));n("#redactorSaveBtn").click(n.proxy(function(){this.imageSave(i)},this))},this);this.modalInit(this.opts.curLang.image,this.opts.modal_image_edit,380,u)},imageRemove:function(t){var i=n(t).parent();n(t).remove();i.length&&i[0].tagName==="P"&&(this.$editor.focus(),this.selectionStart(i));this.callback("imageDelete",t);this.modalClose();this.sync()},imageSave:function(t){var i=n(t).parent(),u,r;n(t).attr("alt",n("#redactor_file_alt").val());u=n("#redactor_form_image_align").val();u==="left"?n(t).css({float:"left",margin:"0 10px 10px 0"}):u==="right"?n(t).css({float:"right",margin:"0 0 10px 10px"}):n(t).css({float:"none",margin:"0"});r=n.trim(n("#redactor_file_link").val());r!==""?n(i).get(0).tagName!=="A"?n(t).replaceWith('<a href="'+r+'">'+this.outerHtml(t)+"<\/a>"):n(i).attr("href",r):n(i).get(0).tagName==="A"&&n(i).replaceWith(this.outerHtml(t));this.modalClose();this.observeImages();this.sync()},imageResize:function(t){var i=n(t),r=!1,u=!1,f,e,o=i.width()/i.height(),s=10;i.off("hover mousedown mouseup click mousemove");i.hover(function(){i.css("cursor","nw-resize")},function(){i.css("cursor","");r=!1});i.mousedown(function(n){n.preventDefault();o=i.width()/i.height();r=!0;u=!0;f=Math.round(n.pageX-i.eq(0).offset().left);e=Math.round(n.pageY-i.eq(0).offset().top)});i.mouseup(n.proxy(function(){r=!1;i.css("cursor","");this.sync()},this));i.click(n.proxy(function(n){u&&this.imageEdit(n)},this));i.mousemove(function(t){if(r){u=!1;var v=Math.round(t.pageX-n(this).eq(0).offset().left)-f,c=Math.round(t.pageY-n(this).eq(0).offset().top)-e,l=i.height(),a=parseInt(l,10)+c,h=Math.round(a*o);h>s&&i.width(h);f=Math.round(t.pageX-n(this).eq(0).offset().left);e=Math.round(t.pageY-n(this).eq(0).offset().top)}})},imageThumbClick:function(t){var i='<img id="image-marker" src="'+n(t.target).attr("rel")+'" alt="'+n(t.target).attr("title")+'" />';this.opts.paragraphy&&(i="<p>"+i+"<\/p>");this.imageInsert(i,!0)},imageCallbackLink:function(){var i=n("#redactor_file_link").val(),t;i!==""?(t='<img id="image-marker" src="'+i+'" />',this.opts.linebreaks===!1&&(t="<p>"+t+"<\/p>"),this.imageInsert(t,!0)):this.modalClose()},imageCallback:function(n){this.imageInsert(n)},imageInsert:function(t,i){var r,u;this.selectionRestore();t!==!1&&(r="",i!==!0?(r='<img id="image-marker" src="'+t.filelink+'" />',this.opts.paragraphy&&(r="<p>"+r+"<\/p>")):r=t,this.execCommand("inserthtml",r,!1),u=n(this.$editor.find("img#image-marker")),u.length?u.removeAttr("id"):u=!1,this.sync(),i!==!0&&this.callback("imageUpload",u,t));this.modalClose();this.observeImages()},modalTemplatesInit:function(){n.extend(this.opts,{modal_file:String()+'<section><div id="redactor-progress" class="redactor-progress redactor-progress-striped" style="display: none;"><div id="redactor-progress-bar" class="redactor-progress-bar" style="width: 100%;"><\/div><\/div><form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label>'+this.opts.curLang.filename+'<\/label><input type="text" id="redactor_filename" class="redactor_input" /><div style="margin-top: 7px;"><input type="file" id="redactor_file" name="file" /><\/div><\/form><\/section>',modal_image_edit:String()+"<section><label>"+this.opts.curLang.title+'<\/label><input id="redactor_file_alt" class="redactor_input" /><label>'+this.opts.curLang.link+'<\/label><input id="redactor_file_link" class="redactor_input" /><label>'+this.opts.curLang.image_position+'<\/label><select id="redactor_form_image_align"><option value="none">'+this.opts.curLang.none+'<\/option><option value="left">'+this.opts.curLang.left+'<\/option><option value="right">'+this.opts.curLang.right+'<\/option><\/select><\/section><footer><a href="#" id="redactor_image_delete_btn" class="redactor_modal_btn">'+this.opts.curLang._delete+'<\/a>&nbsp;&nbsp;&nbsp;<a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'<\/a><input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+this.opts.curLang.save+'" /><\/footer>',modal_image:String()+'<section><div id="redactor_tabs"><a href="#" class="redactor_tabs_act">'+this.opts.curLang.upload+'<\/a><a href="#">'+this.opts.curLang.choose+'<\/a><a href="#">'+this.opts.curLang.link+'<\/a><\/div><div id="redactor-progress" class="redactor-progress redactor-progress-striped" style="display: none;"><div id="redactor-progress-bar" class="redactor-progress-bar" style="width: 100%;"><\/div><\/div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="file" /><\/div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div id="redactor_image_box"><\/div><\/div><\/form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><label>'+this.opts.curLang.image_web_link+'<\/label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /><\/div><\/section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'<\/a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+this.opts.curLang.insert+'" /><\/footer>',modal_link:String()+'<section><form id="redactorInsertLinkForm" method="post" action=""><div id="redactor_tabs"><a href="#" class="redactor_tabs_act">URL<\/a><a href="#">Email<\/a><a href="#">'+this.opts.curLang.anchor+'<\/a><\/div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label>URL<\/label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+this.opts.curLang.text+'<\/label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label><input type="checkbox" id="redactor_link_blank"> '+this.opts.curLang.link_new_tab+'<\/label><\/div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Email<\/label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+this.opts.curLang.text+'<\/label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /><\/div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>'+this.opts.curLang.anchor+'<\/label><input type="text" class="redactor_input" id="redactor_link_anchor"  /><label>'+this.opts.curLang.text+'<\/label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /><\/div><\/form><\/section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'<\/a><input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+this.opts.curLang.insert+'" /><\/footer>',modal_table:String()+"<section><label>"+this.opts.curLang.rows+'<\/label><input type="text" size="5" value="2" id="redactor_table_rows" /><label>'+this.opts.curLang.columns+'<\/label><input type="text" size="5" value="3" id="redactor_table_columns" /><\/section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'<\/a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+this.opts.curLang.insert+'" /><\/footer>',modal_video:String()+'<section><form id="redactorInsertVideoForm"><label>'+this.opts.curLang.video_html_code+'<\/label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"><\/textarea><\/form><\/section><footer><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'<\/a><input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+this.opts.curLang.insert+'" /><\/footer>'})},modalInit:function(t,i,r,u){var o=n("#redactor_modal_overlay"),f,e,s;if(o.length||(this.$overlay=o=n('<div id="redactor_modal_overlay" style="display: none;"><\/div>'),n("body").prepend(this.$overlay)),this.opts.modalOverlay)o.show().on("click",n.proxy(this.modalClose,this));f=n("#redactor_modal");f.length||(this.$modal=f=n('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;<\/div><header id="redactor_modal_header"><\/header><div id="redactor_modal_inner"><\/div><\/div>'),n("body").append(this.$modal));n("#redactor_modal_close").on("click",n.proxy(this.modalClose,this));this.hdlModalClose=n.proxy(function(n){if(n.keyCode===this.keyCode.ESC)return this.modalClose(),!1},this);n(document).keyup(this.hdlModalClose);this.$editor.keyup(this.hdlModalClose);this.modalcontent=!1;i.indexOf("#")==0?(this.modalcontent=n(i),n("#redactor_modal_inner").empty().append(this.modalcontent.html()),this.modalcontent.html("")):n("#redactor_modal_inner").empty().append(i);f.find("#redactor_modal_header").html(t);typeof n.fn.draggable!="undefined"&&(f.draggable({handle:"#redactor_modal_header"}),f.find("#redactor_modal_header").css("cursor","move"));e=n("#redactor_tabs");e.length&&(s=this,e.find("a").each(function(t,i){t++;n(i).on("click",function(i){if(i.preventDefault(),e.find("a").removeClass("redactor_tabs_act"),n(this).addClass("redactor_tabs_act"),n(".redactor_tab").hide(),n("#redactor_tab"+t).show(),n("#redactor_tab_selected").val(t),s.isMobile()===!1){var r=f.outerHeight();f.css("margin-top","-"+(r+10)/2+"px")}})}));f.find(".redactor_btn_modal_close").on("click",n.proxy(this.modalClose,this));this.isMobile()===!1?(f.css({position:"fixed",top:"-2000px",left:"50%",width:r+"px",marginLeft:"-"+(r+60)/2+"px"}).show(),this.modalSaveBodyOveflow=n(document.body).css("overflow"),n(document.body).css("overflow","hidden")):f.css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show();typeof u=="function"&&u();this.isMobile()===!1&&setTimeout(function(){var n=f.outerHeight();f.css({top:"50%",height:"auto",minHeight:"auto",marginTop:"-"+(n+10)/2+"px"})},20)},modalClose:function(){return n("#redactor_modal_close").off("click",this.modalClose),n("#redactor_modal").fadeOut("fast",n.proxy(function(){var t=n("#redactor_modal_inner");this.modalcontent!==!1&&(this.modalcontent.html(t.html()),this.modalcontent=!1);t.html("");this.opts.modalOverlay&&n("#redactor_modal_overlay").hide().off("click",this.modalClose);n(document).unbind("keyup",this.hdlModalClose);this.$editor.unbind("keyup",this.hdlModalClose);this.selectionRestore()},this)),this.isMobile()===!1&&n(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible"),!1},modalSetTab:function(t){n(".redactor_tab").hide();n("#redactor_tabs").find("a").removeClass("redactor_tabs_act").eq(t-1).addClass("redactor_tabs_act");n("#redactor_tab"+t).show()},s3handleFileSelect:function(n){for(var r=n.target.files,t=0,i;i=r[t];t++)this.s3uploadFile(i)},s3uploadFile:function(t){this.s3executeOnSignedUrl(t,n.proxy(function(n){this.s3uploadToS3(t,n)},this))},s3executeOnSignedUrl:function(t,i){var r=new XMLHttpRequest;r.open("GET",this.opts.s3+"?name="+t.name+"&type="+t.type,!0);r.overrideMimeType("text/plain; charset=x-user-defined");r.onreadystatechange=function(){this.readyState==4&&this.status==200?(n("#redactor-progress").fadeIn(),i(decodeURIComponent(this.responseText))):this.readyState==4&&this.status!=200};r.send()},s3createCORSRequest:function(n,t){var i=new XMLHttpRequest;return"withCredentials"in i?i.open(n,t,!0):typeof XDomainRequest!="undefined"?(i=new XDomainRequest,i.open(n,t)):i=null,i},s3uploadToS3:function(t,i){var r=this.s3createCORSRequest("PUT",i);r&&(r.onload=n.proxy(function(){var f,t,u;if(r.status==200){if(n("#redactor-progress").hide(),f=i.split("?"),!f[0])return!1;this.selectionRestore();t="";t='<img id="image-marker" src="'+f[0]+'" />';this.opts.paragraphy&&(t="<p>"+t+"<\/p>");this.execCommand("inserthtml",t,!1);u=n(this.$editor.find("img#image-marker"));u.length?u.removeAttr("id"):u=!1;this.sync();this.callback("imageUpload",u,!1);this.modalClose();this.observeImages()}},this),r.onerror=function(){},r.upload.onprogress=function(){},r.setRequestHeader("Content-Type",t.type),r.setRequestHeader("x-amz-acl","public-read"),r.send(t))},uploadInit:function(t,i){this.uploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1};n.extend(this.uploadOptions,i);var r=n("#"+t);r.length&&r[0].tagName==="INPUT"?(this.uploadOptions.input=r,this.el=n(r[0].form)):this.el=r;this.element_action=this.el.attr("action");this.uploadOptions.auto?n(this.uploadOptions.input).change(n.proxy(function(n){this.el.submit(function(){return!1});this.uploadSubmit(n)},this)):this.uploadOptions.trigger&&n("#"+this.uploadOptions.trigger).click(n.proxy(this.uploadSubmit,this))},uploadSubmit:function(){n("#redactor-progress").fadeIn();this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(Math.random()*99999);var t=this.document.createElement("div"),i='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"><\/iframe>';return t.innerHTML=i,n(t).appendTo("body"),this.uploadOptions.start&&this.uploadOptions.start(),n("#"+this.id).load(n.proxy(this.uploadLoaded,this)),this.id},uploadForm:function(t,i){var r,f,u,e;this.uploadOptions.input?(r="redactorUploadForm"+this.id,f="redactorUploadFile"+this.id,this.form=n('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+i+'" name="'+r+'" id="'+r+'" enctype="multipart/form-data" />'),this.opts.uploadFields!==!1&&typeof this.opts.uploadFields=="object"&&n.each(this.opts.uploadFields,n.proxy(function(t,i){i.toString().indexOf("#")===0&&(i=n(i).val());var r=n("<input/>",{type:"hidden",name:t,value:i});n(this.form).append(r)},this)),u=this.uploadOptions.input,e=n(u).clone(),n(u).attr("id",f).before(e).appendTo(this.form),n(this.form).css("position","absolute").css("top","-2000px").css("left","-2000px").appendTo("body"),this.form.submit()):(t.attr("target",i).attr("method","POST").attr("enctype","multipart/form-data").attr("action",this.uploadOptions.url),this.element.submit())},uploadLoaded:function(){var i=n("#"+this.id)[0],u,f,t,r;u=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:window.frames[this.id].document;this.uploadOptions.success&&(n("#redactor-progress").hide(),typeof u!="undefined"?(f=u.body.innerHTML,t=f.match(/\{(.|\n)*\}/)[0],t=t.replace(/^\[/,""),t=t.replace(/\]$/,""),r=n.parseJSON(t),typeof r.error=="undefined"?this.uploadOptions.success(r):(this.uploadOptions.error(this,r),this.modalClose())):(this.modalClose(),alert("Upload failed!")));this.el.attr("action",this.element_action);this.el.attr("target","")},draguploadInit:function(t,i){if(this.draguploadOptions=n.extend({url:!1,success:!1,error:!1,preview:!1,uploadFields:!1,text:this.opts.curLang.drop_file_here,atext:this.opts.curLang.or_choose},i),window.FormData===undefined)return!1;this.droparea=n('<div class="redactor_droparea"><\/div>');this.dropareabox=n('<div class="redactor_dropareabox">'+this.draguploadOptions.text+"<\/div>");this.dropalternative=n('<div class="redactor_dropalternative">'+this.draguploadOptions.atext+"<\/div>");this.droparea.append(this.dropareabox);n(t).before(this.droparea);n(t).before(this.dropalternative);this.dropareabox.on("dragover",n.proxy(function(){return this.draguploadOndrag()},this));this.dropareabox.on("dragleave",n.proxy(function(){return this.draguploadOndragleave()},this));this.dropareabox.get(0).ondrop=n.proxy(function(n){n.preventDefault();this.dropareabox.removeClass("hover").addClass("drop");this.draguploadUpload(n.dataTransfer.files[0])},this)},draguploadUpload:function(t){var r=jQuery.ajaxSettings.xhr(),u,i;r.upload&&r.upload.addEventListener("progress",n.proxy(this.uploadProgress,this),!1);u=function(){return r};i=new FormData;this.draguploadOptions.uploadFields!==!1&&typeof this.draguploadOptions.uploadFields=="object"&&n.each(this.draguploadOptions.uploadFields,n.proxy(function(t,r){r.toString().indexOf("#")===0&&(r=n(r).val());i.append(t,r)},this));i.append("file",t);n.ajax({url:this.draguploadOptions.url,dataType:"html",data:i,xhr:u,cache:!1,contentType:!1,processData:!1,type:"POST",success:n.proxy(function(t){t=t.replace(/^\[/,"");t=t.replace(/\]$/,"");var i=n.parseJSON(t);typeof i.error=="undefined"?this.draguploadOptions.success(i):(this.draguploadOptions.error(this,i),this.draguploadOptions.success(!1))},this)})},draguploadOndrag:function(){return this.dropareabox.addClass("hover"),!1},draguploadOndragleave:function(){return this.dropareabox.removeClass("hover"),!1},uploadProgress:function(n,t){var i=n.loaded?parseInt(n.loaded/n.total*100,10):n;this.dropareabox.text("Loading "+i+"% "+(t||""))},isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},outerHtml:function(t){return n("<div>").append(n(t).eq(0).clone()).html()},isString:function(n){return Object.prototype.toString.call(n)=="[object String]"},isEmpty:function(n){return n=n.replace(/&#x200b;|<br>|<br\/>|&nbsp;/gi,""),n=n.replace(/\s/g,""),n=n.replace(/^<p>[^\w\d]*?<\/p>$/i,""),n==""},browser:function(n){var t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return n=="version"?i[2]:n=="webkit"?i[1]=="chrome"||i[1]=="webkit":i[1]==n},oldIE:function(){return this.browser("msie")&&parseInt(this.browser("version"),10)<9?!0:!1},getFragmentHtml:function(n){var i=n.cloneNode(!0),t=this.document.createElement("div");return t.appendChild(i),t.innerHTML},extractContent:function(){for(var i=this.$editor[0],n=this.document.createDocumentFragment(),t;t=i.firstChild;)n.appendChild(t);return n},isParentRedactor:function(t){return t?this.opts.iframe?t:n(t).parents("div.redactor_editor").length==0||n(t).hasClass("redactor_editor")?!1:t:!1},currentOrParentIs:function(n){var t=this.getParent(),i=this.getCurrent();return t&&t.tagName===n?t:i&&i.tagName===n?i:!1},isEndOfElement:function(){var t=this.getBlock(),i=this.getCaretOffset(t),r=n.trim(n(t).text()).replace(/\n\r\n/g,""),u=r.length;return i==u?!0:!1},isFocused:function(){var t,i=this.getSelection();return(i.rangeCount&&i.rangeCount>0&&(t=i.getRangeAt(0).startContainer),!t)?!1:this.opts.iframe?this.getCaretOffsetRange().equals()?!this.$editor.is(t):!0:n(t).closest("div.redactor_editor").length!=0},removeEmptyAttr:function(t,i){n(t).attr(i)==""&&n(t).removeAttr(i)},removeFromArrayByValue:function(n,t){for(var i=null;(i=n.indexOf(t))!==-1;)n.splice(i,1);return n}};t.prototype.init.prototype=t.prototype;n.Redactor.fn.formatLinkify=function(t){for(var u=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,f=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,e=(this.$editor?this.$editor.get(0):this).childNodes,o=e.length,i,r;o--;)i=e[o],i.nodeType===3?(r=i.nodeValue,r&&(r.match(u)||r.match(f))&&(r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(u,'$1<a href="'+t+'$2">$2<\/a>$3').replace(f,'$1<a href="$2">$2<\/a>$5'),n(i).after(r).remove())):i.nodeType!==1||/^(a|button|textarea)$/i.test(i.tagName)||n.Redactor.fn.formatLinkify.call(i,t)}}(jQuery),function(n,t){function e(n){var t=this;t.stc=n}function o(n){var t=this;t.stc=n}function s(n){var t=this;t.stc=n}function h(n){var t=this;t.$tabsContainer=n;t.movableContainerLeftPos=0;t.scrollArrowsVisible=!1;t.scrollToTabEdge=!1;t.disableScrollArrowsOnFullyScrolled=!1;t.reverseScroll=!1;t.widthMultiplier=1;t.scrollMovement=new s(t);t.eventHandlers=new o(t);t.elementsHandler=new e(t)}function l(t,i,f){var e=i.tabs,s={paneId:i.propPaneId,title:i.propTitle,active:i.propActive,disabled:i.propDisabled,content:i.propContent},h=i.ignoreTabPanes,l=e.length&&e[0][s.content]!==undefined,a=r.getNewElNavTabs(),v=r.getNewElTabContent(),o,y=h?null:function(){o.after(v)};e.length&&(e.forEach(function(n){r.getNewElTabLi(n,s,!0).appendTo(a);!h&&l&&r.getNewElTabPane(n,s,!0).appendTo(v)}),o=c(a,i,f,y),o.appendTo(t),t.data({scrtabs:{tabs:e,propNames:s,ignoreTabPanes:h,hasTabContent:l,scroller:o}}),o.find(".nav-tabs > li").each(function(t){u.storeDataOnLiEl(n(this),e,t)}))}function a(n){var e=n.updatedTabsArray,t=n.propNames,i=n.ignoreTabPanes,o=n.options,f=n.$currTabLis,h=n.$navTabs,c=i?null:n.$currTabContentPanesContainer,l=i?null:n.$currTabContentPanes,s=!1;return e.forEach(function(n,a){var v=f.find('a[href="#'+n[t.paneId]+'"]'),p=a>=f.length,y;v.length||(s=!0,v=r.getNewElTabLi(n,t,o.forceActiveTab),u.storeDataOnLiEl(v,e,a),p?v.appendTo(h):v.insertBefore(f.eq(a)),i||n[t.content]===undefined||(y=r.getNewElTabPane(n,t,o.forceActiveTab),p?y.appendTo(c):y.insertBefore(l.eq(a))))}),s}function v(n){var u=n.tabLi,s=n.ignoreTabPanes,e=u.$li,o=u.$contentPane,r=u.origTabData,i=u.newTabData,t=n.propNames,f=!1;return r[t.title]!==i[t.title]&&(e.find('a[role="tab"]').html(r[t.title]=i[t.title]),f=!0),n.options.forceActiveTab&&(e[i[t.active]?"addClass":"removeClass"]("active"),o[i[t.active]?"addClass":"removeClass"]("active"),r[t.active]=i[t.active],f=!0),s||r[t.content]===i[t.content]||(o.html(r[t.content]=i[t.content]),f=!0),f}function y(n){var t=n.tabLi,r=n.ignoreTabPanes,f=t.$li,i;return t.newIdx!==-1?!1:(f.hasClass("active")&&(i=u.getIndexOfClosestEnabledTab(n.$currTabLis,t.currDomIdx),i>-1&&(n.$currTabLis.eq(i).addClass("active"),r||n.$currTabContentPanes.eq(i).addClass("active"))),f.remove(),r||t.$contentPane.remove(),!0)}function p(t){var r=t.$currTabLis,f=t.updatedTabsArray,e=t.propNames,i=t.ignoreTabPanes,o=[],s=i?null:[];return u.didTabOrderChange(r,f,e)?(f.forEach(function(t){var u=t[e.paneId];o.push(r.find('a[role="tab"][href="#'+u+'"]').parent("li"));i||s.push(n("#"+u))}),t.$navTabs.append(o),i||t.$currTabContentPanesContainer.append(s),!0):!1}function w(t){var o=t.$currTabLis,f=t.updatedTabsArray,e=t.propNames,i=!1;return o.each(function(o){var s=n(this),c=s.data("tab"),h=u.getTabIndexByPaneId(f,e.paneId,c[e.paneId]),l=h>-1?f[h]:null;if(t.tabLi={$li:s,currDomIdx:o,newIdx:h,$contentPane:r.getElTabPaneForLi(s),origTabData:c,newTabData:l},y(t)){i=!0;return}v(t)&&(i=!0)}),i}function b(){var u=n(this),r=u.data("scrtabs"),f;r&&(r.scroller.off(i.EVENTS.DROPDOWN_MENU_SHOW).off(i.EVENTS.DROPDOWN_MENU_HIDE),r.scroller.find("[data-"+i.DATA_KEY_DDMENU_MODIFIED+"]").css({display:"",left:"",top:""}).off(i.EVENTS.CLICK).removeAttr("data-"+i.DATA_KEY_DDMENU_MODIFIED),r.scroller.hasTabClickHandler&&u.find('a[data-toggle="tab"]').off(".scrtabs"),r.isWrapperOnly?(f=u.parents(".scrtabs-tab-container"),f.length&&f.replaceWith(u)):(r.scroller&&r.scroller.initTabs&&(r.scroller.initTabs=null),u.find(".scrtabs-tab-container").add(".tab-content").remove()),u.removeData("scrtabs"),n(t).off(i.EVENTS.WINDOW_RESIZE),n("body").off(i.EVENTS.FORCE_REFRESH))}function k(t){function u(t){n(t.target).append(r.off(i.EVENTS.CLICK))}function f(u){function l(){var r=n(this),i=r.parent("li"),u=i.parent(".dropdown-menu"),e=r.attr("href");i.hasClass("active")||(t.find("li.active").not(f).add(u.find("li.active")).removeClass("active"),f.add(i).addClass("active"),n(".tab-content .tab-pane.active").removeClass("active"),n(e).addClass("active"))}var f=n(u.target),e=f.offset(),c=t.find('li[role="presentation"].active'),o,s,h;r=f.find(".dropdown-menu").attr("data-"+i.DATA_KEY_DDMENU_MODIFIED,!0);c[0]!==f[0]&&r.find("li.active").removeClass("active");r.on(i.EVENTS.CLICK,'a[role="tab"]',l);n("body").append(r);o=r.width()+e.left;s=t.width()-(i.SCROLL_ARROW_WIDTH+1);h=e.left;o>s&&(h-=o-s);r.css({display:"block",top:e.top+f.outerHeight()-2,left:h})}var r;t.on(i.EVENTS.DROPDOWN_MENU_SHOW,f).on(i.EVENTS.DROPDOWN_MENU_HIDE,u)}function d(n,t){var r=n.data().scrtabs,o=r.scroller,f=n.find(".scrtabs-tab-container .nav-tabs"),e=n.find(".tab-content"),i=!1,u={options:t,updatedTabsArray:r.tabs,propNames:r.propNames,ignoreTabPanes:r.ignoreTabPanes,$navTabs:f,$currTabLis:f.find("> li"),$currTabContentPanesContainer:e,$currTabContentPanes:e.find(".tab-pane")};return a(u)&&(i=!0),p(u)&&(i=!0),w(u)&&(i=!0),i&&o.initTabs(),i}function g(t,r){t.data("scrtabs")&&(t.data("scrtabs").isWrapperOnly||!d(t,r))&&n("body").trigger(i.EVENTS.FORCE_REFRESH)}function nt(){var i=n(this),t=i.data("scrtabs");t&&t.scroller.scrollToActiveTab()}function c(n,t,i,u){var f=r.getNewElScrollerElementWrappingNavTabsInstance(n.clone(!0),t),e=new h(f),o=n.data("scrtabs");return o?o.scroller=f:n.data("scrtabs",{scroller:f}),n.replaceWith(f.css("visibility","hidden")),t.tabClickHandler&&typeof t.tabClickHandler=="function"&&(f.hasTabClickHandler=!0,e.tabClickHandler=t.tabClickHandler),f.initTabs=function(){e.initTabs(t,f,i,u)},f.scrollToActiveTab=function(){e.scrollToActiveTab(t)},f.initTabs(),k(f),f}var i={CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL:50,SCROLL_ARROW_WIDTH:20,SCROLL_OFFSET_FRACTION:6,DATA_KEY_DDMENU_MODIFIED:"scrtabsddmenumodified",DATA_KEY_IS_MOUSEDOWN:"scrtabsismousedown",CSS_CLASSES:{SCROLL_ARROW_DISABLE:"scrtabs-disable"},SLIDE_DIRECTION:{LEFT:1,RIGHT:2},EVENTS:{CLICK:"click.scrtabs",DROPDOWN_MENU_HIDE:"hide.bs.dropdown.scrtabs",DROPDOWN_MENU_SHOW:"show.bs.dropdown.scrtabs",FORCE_REFRESH:"forcerefresh.scrtabs",MOUSEDOWN:"mousedown.scrtabs touchstart.scrtabs",MOUSEUP:"mouseup.scrtabs touchend.scrtabs",WINDOW_RESIZE:"resize.scrtabs",TABS_READY:"ready.scrtabs"}},r,u,f;(function(t){var r=function(n,t,i){var r;return function(){function e(){i||n.apply(u,f);r=null}var u=this,f=arguments;r?clearTimeout(r):i&&n.apply(u,f);r=setTimeout(e,t||100)}};n.fn[t]=function(n){return n?this.bind(i.EVENTS.WINDOW_RESIZE,r(n)):this.trigger(t)}})("smartresize"),function(r){r.initElements=function(){var n=this;n.setElementReferences();n.setEventListeners()};r.refreshAllElementSizes=function(){var i=this,n=i.stc,t=n.scrollMovement,e=n.scrollArrowsVisible,u={didScrollToActiveTab:!1},f=!1,r;return i.setElementWidths(),i.setScrollArrowVisibility(),n.scrollArrowsVisible?(r=t.getMinPos(),f=t.scrollToActiveTab({isOnWindowResize:!0}),f||(t.refreshScrollArrowsDisabledState(),n.movableContainerLeftPos<r&&t.incrementMovableContainerRight(r)),u.didScrollToActiveTab=!0):e&&(n.movableContainerLeftPos=0,t.slideMovableContainerToLeftPos()),u};r.setElementReferences=function(){var e=this,i=e.stc,r=i.$tabsContainer,u=r.find(".scrtabs-tab-scroll-arrow-left"),f=r.find(".scrtabs-tab-scroll-arrow-right");i.isNavPills=!1;i.$fixedContainer=r.find(".scrtabs-tabs-fixed-container");i.$movableContainer=r.find(".scrtabs-tabs-movable-container");i.$tabsUl=r.find(".nav-tabs");i.$tabsUl.length||(i.$tabsUl=r.find(".nav-pills"),i.$tabsUl.length&&(i.isNavPills=!0));i.$tabsLiCollection=i.$tabsUl.find("> li");i.$slideLeftArrow=i.reverseScroll?u:f;i.$slideRightArrow=i.reverseScroll?f:u;i.$scrollArrows=i.$slideLeftArrow.add(i.$slideRightArrow);i.$win=n(t)};r.setElementWidths=function(){var t=this,n=t.stc;n.winWidth=n.$win.width();n.scrollArrowsCombinedWidth=n.$slideLeftArrow.outerWidth()+n.$slideRightArrow.outerWidth();t.setFixedContainerWidth();t.setMovableContainerWidth()};r.setEventListeners=function(){var f=this,r=f.stc,t=r.eventHandlers,u=i.EVENTS;r.$slideLeftArrow.off(".scrtabs").on(u.MOUSEDOWN,function(n){t.handleMousedownOnSlideMovContainerLeftArrow.call(t,n)}).on(u.MOUSEUP,function(n){t.handleMouseupOnSlideMovContainerLeftArrow.call(t,n)}).on(u.CLICK,function(n){t.handleClickOnSlideMovContainerLeftArrow.call(t,n)});r.$slideRightArrow.off(".scrtabs").on(u.MOUSEDOWN,function(n){t.handleMousedownOnSlideMovContainerRightArrow.call(t,n)}).on(u.MOUSEUP,function(n){t.handleMouseupOnSlideMovContainerRightArrow.call(t,n)}).on(u.CLICK,function(n){t.handleClickOnSlideMovContainerRightArrow.call(t,n)});if(r.tabClickHandler)r.$tabsLiCollection.find('a[data-toggle="tab"]').off(u.CLICK).on(u.CLICK,r.tabClickHandler);r.$win.smartresize(function(n){t.handleWindowResize.call(t,n)});n("body").on(i.EVENTS.FORCE_REFRESH,r.elementsHandler.refreshAllElementSizes.bind(r.elementsHandler))};r.setFixedContainerWidth=function(){var i=this,n=i.stc,t=n.$tabsContainer.get(0).getBoundingClientRect();n.fixedContainerWidth=t.width||t.right-t.left;n.fixedContainerWidth=n.fixedContainerWidth*n.widthMultiplier;n.$fixedContainer.width(n.fixedContainerWidth)};r.setFixedContainerWidthForHiddenScrollArrows=function(){var t=this,n=t.stc;n.$fixedContainer.width(n.fixedContainerWidth)};r.setFixedContainerWidthForVisibleScrollArrows=function(){var t=this,n=t.stc;n.$fixedContainer.width(n.fixedContainerWidth-n.scrollArrowsCombinedWidth)};r.setMovableContainerWidth=function(){var r=this,t=r.stc,i=t.$tabsUl.find("> li");t.movableContainerWidth=0;i.length&&(i.each(function(){var i=n(this),r=0;t.isNavPills&&(r=parseInt(i.css("margin-left"),10)+parseInt(i.css("margin-right"),10));t.movableContainerWidth+=i.outerWidth()+r}),t.movableContainerWidth+=1,t.movableContainerWidth<t.fixedContainerWidth&&(t.movableContainerWidth=t.fixedContainerWidth));t.$movableContainer.width(t.movableContainerWidth)};r.setScrollArrowVisibility=function(){var t=this,n=t.stc,i=n.movableContainerWidth>n.fixedContainerWidth;i&&!n.scrollArrowsVisible?(n.$scrollArrows.show(),n.scrollArrowsVisible=!0):!i&&n.scrollArrowsVisible&&(n.$scrollArrows.hide(),n.scrollArrowsVisible=!1);n.scrollArrowsVisible?t.setFixedContainerWidthForVisibleScrollArrows():t.setFixedContainerWidthForHiddenScrollArrows()}}(e.prototype),function(n){n.handleClickOnSlideMovContainerLeftArrow=function(){var n=this,t=n.stc;t.scrollMovement.incrementMovableContainerLeft()};n.handleClickOnSlideMovContainerRightArrow=function(){var n=this,t=n.stc;t.scrollMovement.incrementMovableContainerRight()};n.handleMousedownOnSlideMovContainerLeftArrow=function(){var t=this,n=t.stc;n.$slideLeftArrow.data(i.DATA_KEY_IS_MOUSEDOWN,!0);n.scrollMovement.continueSlideMovableContainerLeft()};n.handleMousedownOnSlideMovContainerRightArrow=function(){var t=this,n=t.stc;n.$slideRightArrow.data(i.DATA_KEY_IS_MOUSEDOWN,!0);n.scrollMovement.continueSlideMovableContainerRight()};n.handleMouseupOnSlideMovContainerLeftArrow=function(){var n=this,t=n.stc;t.$slideLeftArrow.data(i.DATA_KEY_IS_MOUSEDOWN,!1)};n.handleMouseupOnSlideMovContainerRightArrow=function(){var n=this,t=n.stc;t.$slideRightArrow.data(i.DATA_KEY_IS_MOUSEDOWN,!1)};n.handleWindowResize=function(){var i=this,n=i.stc,t=n.$win.width();if(t===n.winWidth)return!1;n.winWidth=t;n.elementsHandler.refreshAllElementSizes()}}(o.prototype),function(t){t.continueSlideMovableContainerLeft=function(){var n=this,t=n.stc;setTimeout(function(){t.movableContainerLeftPos<=n.getMinPos()||!t.$slideLeftArrow.data(i.DATA_KEY_IS_MOUSEDOWN)||n.incrementMovableContainerLeft()||n.continueSlideMovableContainerLeft()},i.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)};t.continueSlideMovableContainerRight=function(){var n=this,t=n.stc;setTimeout(function(){t.movableContainerLeftPos>=0||!t.$slideRightArrow.data(i.DATA_KEY_IS_MOUSEDOWN)||n.incrementMovableContainerRight()||n.continueSlideMovableContainerRight()},i.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)};t.decrementMovableContainerLeftPos=function(n){var r=this,t=r.stc;t.movableContainerLeftPos-=t.fixedContainerWidth/i.SCROLL_OFFSET_FRACTION;t.movableContainerLeftPos<n?t.movableContainerLeftPos=n:t.scrollToTabEdge&&(r.setMovableContainerLeftPosToTabEdge(i.SLIDE_DIRECTION.LEFT),t.movableContainerLeftPos<n&&(t.movableContainerLeftPos=n))};t.disableSlideLeftArrow=function(){var t=this,n=t.stc;n.disableScrollArrowsOnFullyScrolled&&n.scrollArrowsVisible&&n.$slideLeftArrow.addClass(i.CSS_CLASSES.SCROLL_ARROW_DISABLE)};t.disableSlideRightArrow=function(){var t=this,n=t.stc;n.disableScrollArrowsOnFullyScrolled&&n.scrollArrowsVisible&&n.$slideRightArrow.addClass(i.CSS_CLASSES.SCROLL_ARROW_DISABLE)};t.enableSlideLeftArrow=function(){var t=this,n=t.stc;n.disableScrollArrowsOnFullyScrolled&&n.scrollArrowsVisible&&n.$slideLeftArrow.removeClass(i.CSS_CLASSES.SCROLL_ARROW_DISABLE)};t.enableSlideRightArrow=function(){var t=this,n=t.stc;n.disableScrollArrowsOnFullyScrolled&&n.scrollArrowsVisible&&n.$slideRightArrow.removeClass(i.CSS_CLASSES.SCROLL_ARROW_DISABLE)};t.getMinPos=function(){var t=this,n=t.stc;return n.scrollArrowsVisible?n.fixedContainerWidth-n.movableContainerWidth-n.scrollArrowsCombinedWidth:0};t.getMovableContainerCssLeftVal=function(){var t=this,n=t.stc;return n.movableContainerLeftPos===0?"0":n.movableContainerLeftPos+"px"};t.incrementMovableContainerLeft=function(){var n=this,i=n.stc,t=n.getMinPos();return n.decrementMovableContainerLeftPos(t),n.slideMovableContainerToLeftPos(),n.enableSlideRightArrow(),i.movableContainerLeftPos===t};t.incrementMovableContainerRight=function(n){var r=this,t=r.stc;return n?t.movableContainerLeftPos=n:(t.movableContainerLeftPos+=t.fixedContainerWidth/i.SCROLL_OFFSET_FRACTION,t.movableContainerLeftPos>0?t.movableContainerLeftPos=0:t.scrollToTabEdge&&r.setMovableContainerLeftPosToTabEdge(i.SLIDE_DIRECTION.RIGHT)),r.slideMovableContainerToLeftPos(),r.enableSlideLeftArrow(),t.movableContainerLeftPos===0};t.refreshScrollArrowsDisabledState=function(){var n=this,t=n.stc;if(t.disableScrollArrowsOnFullyScrolled&&t.scrollArrowsVisible){if(t.movableContainerLeftPos>=0){n.disableSlideRightArrow();n.enableSlideLeftArrow();return}if(t.movableContainerLeftPos<=n.getMinPos()){n.disableSlideLeftArrow();n.enableSlideRightArrow();return}n.enableSlideLeftArrow();n.enableSlideRightArrow()}};t.scrollToActiveTab=function(){var u=this,n=u.stc,t,r,f,e;if(n.scrollArrowsVisible)return(t=n.$tabsUl.find("li.active"),!t.length)?void 0:(r=t.offset().left-n.$fixedContainer.offset().left,f=r+t.outerWidth(),e=n.fixedContainerWidth-20,f>e)?(n.movableContainerLeftPos-=f-e+i.SCROLL_ARROW_WIDTH,u.slideMovableContainerToLeftPos(),!0):r<i.SCROLL_ARROW_WIDTH?(n.movableContainerLeftPos+=i.SCROLL_ARROW_WIDTH-r,u.slideMovableContainerToLeftPos(),!0):!1};t.setMovableContainerLeftPosToTabEdge=function(t){var f=this,u=f.stc,e=-u.movableContainerLeftPos,r=0;u.$tabsLiCollection.each(function(){var f=n(this).width();return r+=f,r>e?(u.movableContainerLeftPos=t===i.SLIDE_DIRECTION.RIGHT?-(r-f):-r,!1):void 0})};t.slideMovableContainerToLeftPos=function(){var n=this,t=n.stc,i=n.getMinPos(),r;t.movableContainerLeftPos>0?t.movableContainerLeftPos=0:t.movableContainerLeftPos<i&&(t.movableContainerLeftPos=i);t.movableContainerLeftPos=t.movableContainerLeftPos/1;r=n.getMovableContainerCssLeftVal();n.performingSlideAnim=!0;t.$movableContainer.stop().animate({left:r},"slow",function(){var i=n.getMinPos();n.performingSlideAnim=!1;t.movableContainerLeftPos<i?(n.decrementMovableContainerLeftPos(i),t.$movableContainer.stop().animate({left:n.getMovableContainerCssLeftVal()},"fast",function(){n.refreshScrollArrowsDisabledState()})):n.refreshScrollArrowsDisabledState()})}}(s.prototype),function(n){n.initTabs=function(n,t,i,r){function o(){var u;t.find(".nav-tabs").show();e.initElements(n);u=e.refreshAllElementSizes();t.css("visibility","visible");r&&r();i&&i()}var u=this,e=u.elementsHandler,f;n.scrollToTabEdge&&(u.scrollToTabEdge=!0);n.disableScrollArrowsOnFullyScrolled&&(u.disableScrollArrowsOnFullyScrolled=!0);n.reverseScroll&&(u.reverseScroll=!0);n.widthMultiplier!==1&&(f=Number(n.widthMultiplier),isNaN(f)||(u.widthMultiplier=f));setTimeout(o,100)};n.scrollToActiveTab=function(n){var t=this,i=t.scrollMovement;i.scrollToActiveTab(n)}}(h.prototype);r=function(){function i(t){return n(t.find("a").attr("href"))}function r(){return n('<ul class="nav nav-tabs" role="tablist"><\/ul>')}function u(t,i){var f=n('<div class="scrtabs-tab-container"><\/div>'),r=n('<div class="scrtabs-tab-scroll-arrow scrtabs-tab-scroll-arrow-left"><span class="'+i.cssClassLeftArrow+'"><\/span><\/div>'),u=n('<div class="scrtabs-tab-scroll-arrow scrtabs-tab-scroll-arrow-right"><span class="'+i.cssClassRightArrow+'"><\/span><\/div>'),e=n('<div class="scrtabs-tabs-fixed-container"><\/div>'),o=n('<div class="scrtabs-tabs-movable-container"><\/div>');return i.disableScrollArrowsOnFullyScrolled&&r.add(u).addClass("scrtabs-disable"),f.append(r,e.append(o.append(t)),u)}function t(t,i){return n('<a role="tab" data-toggle="tab"><\/a>').attr("href","#"+t[i.paneId]).html(t[i.title])}function f(){return n('<div class="tab-content"><\/div>')}function e(i,r,u){var f=n('<li role="presentation" class=""><\/li>'),e=t(i,r).appendTo(f);return i[r.disabled]?(f.addClass("disabled"),e.attr("data-toggle","")):u&&i[r.active]&&f.addClass("active"),f}function o(t,i,r){var u=n('<div role="tabpanel" class="tab-pane"><\/div>').attr("id",t[i.paneId]).html(t[i.content]);return r&&t[i.active]&&u.addClass("active"),u}return{getElTabPaneForLi:i,getNewElNavTabs:r,getNewElScrollerElementWrappingNavTabsInstance:u,getNewElTabAnchor:t,getNewElTabContent:f,getNewElTabLi:e,getNewElTabPane:o}}();u=function(){function i(i,r,u){var f=!1;return i.each(function(i){var e=t(r,u.paneId,n(this).data("tab")[u.paneId]);if(e>-1&&e!==i)return f=!0,!1}),f}function r(n,t){for(var f=n.length-1,r=-1,u=0,i=0;r===-1&&i>=0;)((i=t+ ++u)<=f&&!n.eq(i).hasClass("disabled")||(i=t-u)>=0&&!n.eq(i).hasClass("disabled"))&&(r=i);return r}function t(n,t,i){var r=-1;return n.some(function(n,u){if(n[t]===i)return r=u,!0}),r}function u(t,i,r){t.data({tab:n.extend({},i[r]),index:r})}return{didTabOrderChange:i,getIndexOfClosestEnabledTab:r,getTabIndexByPaneId:t,storeDataOnLiEl:u}}();f={destroy:function(){var n=this;return n.each(b)},init:function(t){var r=this,f=r.length-1,u=n.extend({},n.fn.scrollingTabs.defaults,t||{});return u.tabs?r.each(function(t){var e=n(this),o=t<f?null:function(){r.trigger(i.EVENTS.TABS_READY)};l(e,u,o)}):r.each(function(t){var e=n(this).data({scrtabs:{isWrapperOnly:!0}}),o=t<f?null:function(){r.trigger(i.EVENTS.TABS_READY)};c(e,u,o)})},refresh:function(t){var i=this,r=n.extend({},n.fn.scrollingTabs.defaults,t||{});return i.each(function(){g(n(this),r)})},scrollToActiveTab:function(){return this.each(nt)}};n.fn.scrollingTabs=function(t){if(f[t])return f[t].apply(this,Array.prototype.slice.call(arguments,1));if(t&&typeof t!="object")n.error("Method "+t+" does not exist on $.scrollingTabs.");else return f.init.apply(this,arguments)};n.fn.scrollingTabs.defaults={tabs:null,propPaneId:"paneId",propTitle:"title",propActive:"active",propDisabled:"disabled",propContent:"content",ignoreTabPanes:!1,scrollToTabEdge:!1,disableScrollArrowsOnFullyScrolled:!1,forceActiveTab:!1,reverseScroll:!1,widthMultiplier:1,tabClickHandler:null,cssClassLeftArrow:"glyphicon glyphicon-chevron-left",cssClassRightArrow:"glyphicon glyphicon-chevron-right"}}(jQuery,window)